

============================== 19:19:32.286402 | c3e9248e-6e56-410b-9a96-e8763daae957 ==============================
[0m19:19:32.286402 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:19:32.297451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --target prod', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:19:32.298077 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:19:32.322890 [info ] [MainThread]: dbt version: 1.9.0
[0m19:19:32.323324 [info ] [MainThread]: python version: 3.12.4
[0m19:19:32.323652 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:19:32.323940 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m19:19:32.328120 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DB_USER'
[0m19:19:32.330331 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.091229334, "process_in_blocks": "0", "process_kernel_time": 0.058061, "process_mem_max_rss": "102504", "process_out_blocks": "1467", "process_user_time": 1.045107}
[0m19:19:32.330832 [debug] [MainThread]: Command `dbt debug` failed at 19:19:32.330725 after 0.09 seconds
[0m19:19:32.331126 [debug] [MainThread]: Flushing usage events


============================== 19:20:17.995959 | c44905c8-dcdb-4ea2-9db4-347c91d35056 ==============================
[0m19:20:17.995959 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:20:18.007354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --target prod', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:20:18.008095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:20:18.033282 [info ] [MainThread]: dbt version: 1.9.0
[0m19:20:18.033708 [info ] [MainThread]: python version: 3.12.4
[0m19:20:18.034022 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:20:18.034381 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m19:20:18.083439 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m19:20:18.083894 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m19:20:18.084219 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m19:20:18.084664 [info ] [MainThread]: adapter type: postgres
[0m19:20:18.084988 [info ] [MainThread]: adapter version: 1.9.0
[0m19:20:18.085341 [info ] [MainThread]: Configuration:
[0m19:20:18.085657 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:20:18.085930 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m19:20:18.086244 [info ] [MainThread]: Required dependencies:
[0m19:20:18.086722 [debug] [MainThread]: Executing "git --help"
[0m19:20:18.103758 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:20:18.104271 [debug] [MainThread]: STDERR: "b''"
[0m19:20:18.104624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:20:18.104956 [info ] [MainThread]: Connection:
[0m19:20:18.105261 [info ] [MainThread]:   host: db
[0m19:20:18.105548 [info ] [MainThread]:   port: 5432
[0m19:20:18.105827 [info ] [MainThread]:   user: prod_app_user_2025
[0m19:20:18.106110 [info ] [MainThread]:   database: primary_app_db
[0m19:20:18.106383 [info ] [MainThread]:   schema: public
[0m19:20:18.106718 [info ] [MainThread]:   connect_timeout: 10
[0m19:20:18.106979 [info ] [MainThread]:   role: None
[0m19:20:18.107228 [info ] [MainThread]:   search_path: None
[0m19:20:18.107508 [info ] [MainThread]:   keepalives_idle: 0
[0m19:20:18.107794 [info ] [MainThread]:   sslmode: None
[0m19:20:18.108069 [info ] [MainThread]:   sslcert: None
[0m19:20:18.108321 [info ] [MainThread]:   sslkey: None
[0m19:20:18.108619 [info ] [MainThread]:   sslrootcert: None
[0m19:20:18.108916 [info ] [MainThread]:   application_name: dbt
[0m19:20:18.109203 [info ] [MainThread]:   retries: 1
[0m19:20:18.109642 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:20:18.162453 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:20:18.191822 [debug] [MainThread]: Using postgres connection "debug"
[0m19:20:18.195479 [debug] [MainThread]: On debug: select 1 as id
[0m19:20:18.195812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:18.236730 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m19:20:18.238055 [debug] [MainThread]: On debug: Close
[0m19:20:18.238523 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:20:18.238923 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:20:18.239298 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project/dbt_project.yml> not found

[0m19:20:18.241031 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.29268742, "process_in_blocks": "0", "process_kernel_time": 0.076869, "process_mem_max_rss": "116360", "process_out_blocks": "1500", "process_user_time": 1.180004}
[0m19:20:18.241552 [debug] [MainThread]: Command `dbt debug` failed at 19:20:18.241457 after 0.29 seconds
[0m19:20:18.241993 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:20:18.242349 [debug] [MainThread]: Flushing usage events


============================== 19:21:32.922794 | 387a7b5c-cdb1-4df5-a774-97aa770f3bd1 ==============================
[0m19:21:32.922794 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:21:32.931098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:21:32.931701 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:21:32.937492 [info ] [MainThread]: dbt version: 1.9.0
[0m19:21:32.937824 [info ] [MainThread]: python version: 3.12.4
[0m19:21:32.938116 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:21:32.938408 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m19:21:32.987281 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m19:21:32.987755 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m19:21:32.988060 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m19:21:32.988521 [info ] [MainThread]: adapter type: postgres
[0m19:21:32.988869 [info ] [MainThread]: adapter version: 1.9.0
[0m19:21:33.066357 [info ] [MainThread]: Configuration:
[0m19:21:33.066843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:21:33.067154 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:21:33.067496 [info ] [MainThread]: Required dependencies:
[0m19:21:33.067969 [debug] [MainThread]: Executing "git --help"
[0m19:21:33.084154 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:21:33.084729 [debug] [MainThread]: STDERR: "b''"
[0m19:21:33.085025 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:21:33.085296 [info ] [MainThread]: Connection:
[0m19:21:33.085566 [info ] [MainThread]:   host: db
[0m19:21:33.085830 [info ] [MainThread]:   port: 5432
[0m19:21:33.086138 [info ] [MainThread]:   user: prod_app_user_2025
[0m19:21:33.086506 [info ] [MainThread]:   database: primary_app_db
[0m19:21:33.086803 [info ] [MainThread]:   schema: public
[0m19:21:33.087085 [info ] [MainThread]:   connect_timeout: 10
[0m19:21:33.087360 [info ] [MainThread]:   role: None
[0m19:21:33.087636 [info ] [MainThread]:   search_path: None
[0m19:21:33.087897 [info ] [MainThread]:   keepalives_idle: 0
[0m19:21:33.088162 [info ] [MainThread]:   sslmode: None
[0m19:21:33.088448 [info ] [MainThread]:   sslcert: None
[0m19:21:33.088809 [info ] [MainThread]:   sslkey: None
[0m19:21:33.089136 [info ] [MainThread]:   sslrootcert: None
[0m19:21:33.089457 [info ] [MainThread]:   application_name: dbt
[0m19:21:33.089762 [info ] [MainThread]:   retries: 1
[0m19:21:33.090202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:21:33.140392 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:21:33.167122 [debug] [MainThread]: Using postgres connection "debug"
[0m19:21:33.167519 [debug] [MainThread]: On debug: select 1 as id
[0m19:21:33.167798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:33.209151 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m19:21:33.210495 [debug] [MainThread]: On debug: Close
[0m19:21:33.211003 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:21:33.211412 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:21:33.214296 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35637176, "process_in_blocks": "0", "process_kernel_time": 0.071867, "process_mem_max_rss": "119664", "process_out_blocks": "12", "process_user_time": 1.213769}
[0m19:21:33.214874 [debug] [MainThread]: Command `dbt debug` succeeded at 19:21:33.214765 after 0.36 seconds
[0m19:21:33.215237 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:21:33.215633 [debug] [MainThread]: Flushing usage events


============================== 19:21:34.334576 | ff7bee23-3103-4220-9d0c-c20328017ff7 ==============================
[0m19:21:34.334576 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:21:34.341642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:21:34.342301 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:21:34.521732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:21:34.575351 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m19:21:34.576352 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:21:35.331159 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_models.stg_products' (models/staging/stg_products.sql) depends on a source named 'public.raw_products' which was not found
[0m19:21:35.333380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0644851, "process_in_blocks": "0", "process_kernel_time": 0.070977, "process_mem_max_rss": "114316", "process_out_blocks": "3", "process_user_time": 1.910385}
[0m19:21:35.333949 [debug] [MainThread]: Command `dbt run` failed at 19:21:35.333832 after 1.07 seconds
[0m19:21:35.334519 [debug] [MainThread]: Flushing usage events


============================== 19:22:27.452708 | 207d3fd0-07bb-493f-8a2f-28112a615d1e ==============================
[0m19:22:27.452708 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:22:27.461025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --target prod', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:22:27.461638 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:22:27.467615 [info ] [MainThread]: dbt version: 1.9.0
[0m19:22:27.467960 [info ] [MainThread]: python version: 3.12.4
[0m19:22:27.468239 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:22:27.468515 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m19:22:27.518385 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m19:22:27.518893 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m19:22:27.519230 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m19:22:27.519743 [info ] [MainThread]: adapter type: postgres
[0m19:22:27.520071 [info ] [MainThread]: adapter version: 1.9.0
[0m19:22:27.597756 [info ] [MainThread]: Configuration:
[0m19:22:27.598178 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:22:27.598556 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:22:27.598870 [info ] [MainThread]: Required dependencies:
[0m19:22:27.599425 [debug] [MainThread]: Executing "git --help"
[0m19:22:27.616212 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:27.616768 [debug] [MainThread]: STDERR: "b''"
[0m19:22:27.617098 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:22:27.617426 [info ] [MainThread]: Connection:
[0m19:22:27.617770 [info ] [MainThread]:   host: db
[0m19:22:27.618076 [info ] [MainThread]:   port: 5432
[0m19:22:27.618365 [info ] [MainThread]:   user: prod_app_user_2025
[0m19:22:27.618679 [info ] [MainThread]:   database: primary_app_db
[0m19:22:27.618984 [info ] [MainThread]:   schema: public
[0m19:22:27.619275 [info ] [MainThread]:   connect_timeout: 10
[0m19:22:27.619538 [info ] [MainThread]:   role: None
[0m19:22:27.619819 [info ] [MainThread]:   search_path: None
[0m19:22:27.620077 [info ] [MainThread]:   keepalives_idle: 0
[0m19:22:27.620340 [info ] [MainThread]:   sslmode: None
[0m19:22:27.620630 [info ] [MainThread]:   sslcert: None
[0m19:22:27.620916 [info ] [MainThread]:   sslkey: None
[0m19:22:27.621187 [info ] [MainThread]:   sslrootcert: None
[0m19:22:27.621433 [info ] [MainThread]:   application_name: dbt
[0m19:22:27.621703 [info ] [MainThread]:   retries: 1
[0m19:22:27.622111 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:22:27.668642 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:22:27.696609 [debug] [MainThread]: Using postgres connection "debug"
[0m19:22:27.697044 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:27.697349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:27.740828 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m19:22:27.742169 [debug] [MainThread]: On debug: Close
[0m19:22:27.742715 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:22:27.743128 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:22:27.746114 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3585245, "process_in_blocks": "0", "process_kernel_time": 0.099878, "process_mem_max_rss": "119612", "process_out_blocks": "12", "process_user_time": 1.19455}
[0m19:22:27.746720 [debug] [MainThread]: Command `dbt debug` succeeded at 19:22:27.746609 after 0.36 seconds
[0m19:22:27.747065 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:22:27.747461 [debug] [MainThread]: Flushing usage events


============================== 19:22:28.855750 | a0b46fef-3167-46d2-9581-76492b423568 ==============================
[0m19:22:28.855750 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:22:28.862749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target prod', 'send_anonymous_usage_stats': 'False'}
[0m19:22:28.863351 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:22:29.041026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:22:29.094985 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m19:22:29.095937 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:22:30.063071 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m19:22:30.065460 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m19:22:30.087978 [info ] [MainThread]: Found 5 models, 3 sources, 429 macros
[0m19:22:30.089805 [info ] [MainThread]: 
[0m19:22:30.090207 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m19:22:30.090567 [info ] [MainThread]: 
[0m19:22:30.091109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:22:30.095545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m19:22:30.096212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m19:22:30.122042 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m19:22:30.122703 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m19:22:30.122342 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m19:22:30.123009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:30.123284 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m19:22:30.124515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:30.180656 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m19:22:30.180938 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m19:22:30.182351 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m19:22:30.183329 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m19:22:30.184440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_staging)
[0m19:22:30.184717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_analytics)
[0m19:22:30.185683 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_analytics"
"
[0m19:22:30.185307 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_staging"
"
[0m19:22:30.189443 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m19:22:30.191671 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: BEGIN
[0m19:22:30.191399 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m19:22:30.192159 [debug] [ThreadPool]: On create_primary_app_db_public_staging: BEGIN
[0m19:22:30.191914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:30.192429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:30.197790 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m19:22:30.198058 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m19:22:30.198323 [debug] [ThreadPool]: On create_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_staging"} */
create schema if not exists "public_staging"
[0m19:22:30.198958 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m19:22:30.199756 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m19:22:30.199960 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m19:22:30.200550 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m19:22:30.200216 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m19:22:30.201057 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m19:22:30.200810 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m19:22:30.201611 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m19:22:30.202379 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m19:22:30.202804 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m19:22:30.202591 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m19:22:30.203054 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m19:22:30.203306 [debug] [ThreadPool]: On create_primary_app_db_public_staging: Close
[0m19:22:30.203932 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.204206 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: Close
[0m19:22:30.206076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_staging, now list_primary_app_db_public_staging)
[0m19:22:30.206451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_analytics, now list_primary_app_db_public_analytics)
[0m19:22:30.236738 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m19:22:30.238155 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m19:22:30.238529 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m19:22:30.238845 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m19:22:30.239144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:30.239431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:30.244738 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m19:22:30.244996 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m19:22:30.245285 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m19:22:30.245594 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m19:22:30.245923 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:22:30.246275 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:22:30.248565 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m19:22:30.248773 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m19:22:30.249801 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m19:22:30.250833 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m19:22:30.251278 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m19:22:30.251565 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m19:22:30.255472 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.255809 [debug] [MainThread]: On master: BEGIN
[0m19:22:30.256110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:30.260836 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:22:30.261130 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.261511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:22:30.264117 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m19:22:30.265291 [debug] [MainThread]: On master: ROLLBACK
[0m19:22:30.265649 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.265917 [debug] [MainThread]: On master: BEGIN
[0m19:22:30.266320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:22:30.266651 [debug] [MainThread]: On master: COMMIT
[0m19:22:30.266910 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.267164 [debug] [MainThread]: On master: COMMIT
[0m19:22:30.267490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.267779 [debug] [MainThread]: On master: Close
[0m19:22:30.269782 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m19:22:30.270077 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m19:22:30.270351 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m19:22:30.270839 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m19:22:30.272106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m19:22:30.271732 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m19:22:30.271271 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m19:22:30.272428 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m19:22:30.272867 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m19:22:30.273291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m19:22:30.278793 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m19:22:30.279147 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m19:22:30.279473 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m19:22:30.281836 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m19:22:30.283765 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m19:22:30.285344 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m19:22:30.285643 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m19:22:30.297618 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m19:22:30.311713 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m19:22:30.313754 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m19:22:30.315732 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m19:22:30.317739 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:22:30.318099 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m19:22:30.318376 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:22:30.318629 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:22:30.318924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:22:30.319249 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m19:22:30.319556 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m19:22:30.320326 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:22:30.320684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:30.327579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:22:30.327935 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:22:30.328176 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m19:22:30.328744 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m19:22:30.329049 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m19:22:30.329378 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:22:30.329844 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:22:30.330250 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m19:22:30.330732 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m19:22:30.331076 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m19:22:30.337081 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:22:30.337346 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:22:30.337604 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:22:30.337945 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m19:22:30.340033 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:22:30.342093 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:22:30.342545 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:22:30.342825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:22:30.343108 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:22:30.349762 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:22:30.354673 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m19:22:30.355840 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m19:22:30.356124 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:22:30.356442 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:22:30.356779 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:22:30.357831 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m19:22:30.358786 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:22:30.358479 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m19:22:30.358145 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m19:22:30.359077 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m19:22:30.359842 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.360109 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.360345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:22:30.364703 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m19:22:30.366295 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m19:22:30.371820 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:22:30.371318 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:22:30.367765 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m19:22:30.372955 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:22:30.372497 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m19:22:30.372132 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m19:22:30.373272 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m19:22:30.373804 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:22:30.374084 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:22:30.374400 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:22:30.376209 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m19:22:30.377254 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m19:22:30.378235 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m19:22:30.379776 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:22:30.380339 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:22:30.382142 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m19:22:30.381665 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m19:22:30.380970 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:22:30.382746 [debug] [Thread-2 (]: Began running node model.data_models.dim_products
[0m19:22:30.383233 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m19:22:30.383629 [info ] [Thread-2 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m19:22:30.384179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_models.stg_orders, now model.data_models.dim_products)
[0m19:22:30.384505 [debug] [Thread-2 (]: Began compiling node model.data_models.dim_products
[0m19:22:30.386668 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m19:22:30.387695 [debug] [Thread-2 (]: Began executing node model.data_models.dim_products
[0m19:22:30.404081 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m19:22:30.404963 [debug] [Thread-2 (]: Using postgres connection "model.data_models.dim_products"
[0m19:22:30.405267 [debug] [Thread-2 (]: On model.data_models.dim_products: BEGIN
[0m19:22:30.405537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:22:30.410554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m19:22:30.410855 [debug] [Thread-2 (]: Using postgres connection "model.data_models.dim_products"
[0m19:22:30.411174 [debug] [Thread-2 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m19:22:30.413726 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.002 seconds
[0m19:22:30.415850 [debug] [Thread-2 (]: Using postgres connection "model.data_models.dim_products"
[0m19:22:30.416190 [debug] [Thread-2 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m19:22:30.416865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:22:30.420578 [debug] [Thread-2 (]: On model.data_models.dim_products: COMMIT
[0m19:22:30.420864 [debug] [Thread-2 (]: Using postgres connection "model.data_models.dim_products"
[0m19:22:30.421130 [debug] [Thread-2 (]: On model.data_models.dim_products: COMMIT
[0m19:22:30.421779 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.424068 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m19:22:30.426097 [debug] [Thread-2 (]: Using postgres connection "model.data_models.dim_products"
[0m19:22:30.426411 [debug] [Thread-2 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m19:22:30.426795 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:22:30.427827 [debug] [Thread-2 (]: On model.data_models.dim_products: Close
[0m19:22:30.428435 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.04s]
[0m19:22:30.428989 [debug] [Thread-2 (]: Finished running node model.data_models.dim_products
[0m19:22:30.430212 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m19:22:30.430586 [info ] [Thread-3 (]: 5 of 5 START sql table model public_analytics.fact_sales ....................... [RUN]
[0m19:22:30.430945 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m19:22:30.431234 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m19:22:30.434262 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m19:22:30.435045 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m19:22:30.437158 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m19:22:30.437902 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:22:30.438188 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m19:22:30.438453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:22:30.443379 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:22:30.443680 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:22:30.444034 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

  
    

  create  table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()
  );
  
[0m19:22:30.447346 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m19:22:30.449571 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:22:30.449864 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m19:22:30.450284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:22:30.451341 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m19:22:30.451622 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:22:30.451917 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m19:22:30.452408 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.453934 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_analytics"."fact_sales__dbt_backup"
[0m19:22:30.454384 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:22:30.454690 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
drop table if exists "primary_app_db"."public_analytics"."fact_sales__dbt_backup" cascade
[0m19:22:30.455051 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:22:30.456092 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m19:22:30.456690 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_analytics.fact_sales .................. [[32mSELECT 0[0m in 0.03s]
[0m19:22:30.457197 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m19:22:30.458466 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.458793 [debug] [MainThread]: On master: BEGIN
[0m19:22:30.459066 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:22:30.463969 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:22:30.464429 [debug] [MainThread]: On master: COMMIT
[0m19:22:30.464707 [debug] [MainThread]: Using postgres connection "master"
[0m19:22:30.464956 [debug] [MainThread]: On master: COMMIT
[0m19:22:30.465255 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:22:30.465514 [debug] [MainThread]: On master: Close
[0m19:22:30.465855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:30.466104 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m19:22:30.466326 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m19:22:30.466577 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m19:22:30.467087 [info ] [MainThread]: 
[0m19:22:30.467417 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:22:30.468580 [debug] [MainThread]: Command end result
[0m19:22:30.487795 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m19:22:30.489157 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m19:22:30.494273 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m19:22:30.494550 [info ] [MainThread]: 
[0m19:22:30.494886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:30.495181 [info ] [MainThread]: 
[0m19:22:30.495530 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:22:30.496673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7062204, "process_in_blocks": "0", "process_kernel_time": 0.114061, "process_mem_max_rss": "132332", "process_out_blocks": "2748", "process_user_time": 2.511357}
[0m19:22:30.497114 [debug] [MainThread]: Command `dbt run` succeeded at 19:22:30.497025 after 1.71 seconds
[0m19:22:30.497413 [debug] [MainThread]: Flushing usage events


============================== 19:57:45.777711 | fdfb456f-8fc3-4447-b70c-69719450fa74 ==============================
[0m19:57:45.777711 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:57:45.785624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --target prod', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:57:45.786226 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:57:45.792899 [info ] [MainThread]: dbt version: 1.9.0
[0m19:57:45.793257 [info ] [MainThread]: python version: 3.12.4
[0m19:57:45.793545 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:57:45.793808 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m19:57:45.860908 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m19:57:45.861508 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m19:57:45.861856 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m19:57:45.862379 [info ] [MainThread]: adapter type: postgres
[0m19:57:45.862701 [info ] [MainThread]: adapter version: 1.9.0
[0m19:57:45.962589 [info ] [MainThread]: Configuration:
[0m19:57:45.963181 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:57:45.963582 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:57:45.963923 [info ] [MainThread]: Required dependencies:
[0m19:57:45.964468 [debug] [MainThread]: Executing "git --help"
[0m19:57:45.983050 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:57:45.983862 [debug] [MainThread]: STDERR: "b''"
[0m19:57:45.984231 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:57:45.984562 [info ] [MainThread]: Connection:
[0m19:57:45.984915 [info ] [MainThread]:   host: db
[0m19:57:45.985234 [info ] [MainThread]:   port: 5432
[0m19:57:45.985504 [info ] [MainThread]:   user: prod_app_user_2025
[0m19:57:45.985795 [info ] [MainThread]:   database: primary_app_db
[0m19:57:45.986098 [info ] [MainThread]:   schema: public
[0m19:57:45.986353 [info ] [MainThread]:   connect_timeout: 10
[0m19:57:45.986604 [info ] [MainThread]:   role: None
[0m19:57:45.986889 [info ] [MainThread]:   search_path: None
[0m19:57:45.987215 [info ] [MainThread]:   keepalives_idle: 0
[0m19:57:45.987502 [info ] [MainThread]:   sslmode: None
[0m19:57:45.987759 [info ] [MainThread]:   sslcert: None
[0m19:57:45.988046 [info ] [MainThread]:   sslkey: None
[0m19:57:45.988306 [info ] [MainThread]:   sslrootcert: None
[0m19:57:45.988566 [info ] [MainThread]:   application_name: dbt
[0m19:57:45.988838 [info ] [MainThread]:   retries: 1
[0m19:57:45.989350 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:57:46.040241 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:57:46.075491 [debug] [MainThread]: Using postgres connection "debug"
[0m19:57:46.079050 [debug] [MainThread]: On debug: select 1 as id
[0m19:57:46.079407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:46.124068 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m19:57:46.125428 [debug] [MainThread]: On debug: Close
[0m19:57:46.125903 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:57:46.126290 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:57:46.129516 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41839725, "process_in_blocks": "0", "process_kernel_time": 0.139023, "process_mem_max_rss": "119504", "process_out_blocks": "12", "process_user_time": 1.278217}
[0m19:57:46.130066 [debug] [MainThread]: Command `dbt debug` succeeded at 19:57:46.129965 after 0.42 seconds
[0m19:57:46.130492 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:57:46.130977 [debug] [MainThread]: Flushing usage events


============================== 19:57:47.334817 | f5f281d0-00a7-4ecd-bab8-57bb0a7bfa12 ==============================
[0m19:57:47.334817 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:57:47.341817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:57:47.342443 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:57:47.523225 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:57:47.581544 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m19:57:47.665652 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:57:48.640259 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m19:57:48.642829 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m19:57:48.658494 [info ] [MainThread]: Found 5 models, 3 sources, 429 macros
[0m19:57:48.660498 [info ] [MainThread]: 
[0m19:57:48.660896 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m19:57:48.661201 [info ] [MainThread]: 
[0m19:57:48.661757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:57:48.666382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m19:57:48.667134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m19:57:48.721677 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m19:57:48.722386 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m19:57:48.722039 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m19:57:48.723070 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m19:57:48.722708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:48.723367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:48.775496 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m19:57:48.775875 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m19:57:48.777435 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m19:57:48.778561 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m19:57:48.781172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m19:57:48.781611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m19:57:48.786104 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m19:57:48.787395 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m19:57:48.787810 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m19:57:48.788259 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m19:57:48.788545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:48.788824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:48.794611 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m19:57:48.795039 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m19:57:48.796842 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m19:57:48.797444 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:57:48.797733 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m19:57:48.798017 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m19:57:48.799502 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m19:57:48.800635 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m19:57:48.800877 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m19:57:48.802237 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m19:57:48.801348 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m19:57:48.802603 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m19:57:48.808128 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:48.808475 [debug] [MainThread]: On master: BEGIN
[0m19:57:48.808765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:48.814074 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:57:48.814365 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:48.814729 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:57:48.817954 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m19:57:48.819319 [debug] [MainThread]: On master: ROLLBACK
[0m19:57:48.819668 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:48.819944 [debug] [MainThread]: On master: BEGIN
[0m19:57:48.820333 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:57:48.820600 [debug] [MainThread]: On master: COMMIT
[0m19:57:48.820856 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:48.821124 [debug] [MainThread]: On master: COMMIT
[0m19:57:48.821461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:57:48.821771 [debug] [MainThread]: On master: Close
[0m19:57:48.823806 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m19:57:48.824102 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m19:57:48.824373 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m19:57:48.824824 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m19:57:48.825371 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m19:57:48.825819 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m19:57:48.826181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m19:57:48.826553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m19:57:48.827001 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m19:57:48.827315 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m19:57:48.827646 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m19:57:48.827987 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m19:57:48.833769 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m19:57:48.835776 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m19:57:48.837681 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m19:57:48.839364 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m19:57:48.839722 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m19:57:48.866134 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m19:57:48.870317 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m19:57:48.871219 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m19:57:48.873477 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m19:57:48.875109 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.875399 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.875747 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.875986 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m19:57:48.876281 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m19:57:48.877164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:48.876876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:48.876571 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m19:57:48.877797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:57:48.882849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m19:57:48.883161 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:57:48.883473 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.883768 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.884155 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m19:57:48.884520 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m19:57:48.885625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m19:57:48.886149 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.887300 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m19:57:48.887030 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:57:48.886740 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:57:48.892598 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.892906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:57:48.894970 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.895342 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:57:48.897327 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.898071 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m19:57:48.897634 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m19:57:48.898329 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:48.898838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:48.900757 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.901016 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:57:48.903015 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.903400 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:57:48.905402 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.906155 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:57:48.905722 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m19:57:48.906404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:48.914312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m19:57:48.914531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m19:57:48.919710 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m19:57:48.920796 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m19:57:48.922551 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.922212 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.921860 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m19:57:48.923497 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.923185 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m19:57:48.922846 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m19:57:48.923782 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m19:57:48.924542 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m19:57:48.925024 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m19:57:48.924807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:57:48.929550 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m19:57:48.931820 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m19:57:48.937455 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m19:57:48.936957 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m19:57:48.933283 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m19:57:48.938620 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m19:57:48.938142 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m19:57:48.937771 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m19:57:48.938925 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m19:57:48.940783 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:57:48.941268 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:57:48.941052 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:57:48.943088 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m19:57:48.944103 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m19:57:48.945039 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m19:57:48.946706 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:57:48.947168 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.12s]
[0m19:57:48.948699 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m19:57:48.948276 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m19:57:48.947682 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.12s]
[0m19:57:48.949219 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m19:57:48.949856 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m19:57:48.950306 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m19:57:48.950921 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m19:57:48.951266 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m19:57:48.953601 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m19:57:48.954659 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m19:57:48.970904 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m19:57:48.972023 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.972331 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m19:57:48.972613 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:57:48.977833 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m19:57:48.978180 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.978663 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m19:57:48.981514 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m19:57:48.983713 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.984007 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m19:57:48.984430 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:48.986369 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.986643 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m19:57:48.987022 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:48.990823 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m19:57:48.991148 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.991430 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m19:57:48.992002 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m19:57:48.993535 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m19:57:48.995517 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m19:57:48.995810 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m19:57:48.997283 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:57:48.998312 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m19:57:48.998914 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m19:57:48.999485 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m19:57:49.000856 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m19:57:49.001374 [info ] [Thread-3 (]: 5 of 5 START sql table model public_analytics.fact_sales ....................... [RUN]
[0m19:57:49.001705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m19:57:49.001991 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m19:57:49.004757 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m19:57:49.005679 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m19:57:49.007722 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m19:57:49.008265 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.008530 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m19:57:49.008776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:57:49.013777 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:57:49.014066 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.014409 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

  
    

  create  table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()
  );
  
[0m19:57:49.017727 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m19:57:49.020105 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.020390 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales" rename to "fact_sales__dbt_backup"
[0m19:57:49.020840 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:49.023656 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.023988 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m19:57:49.024385 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:57:49.025487 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m19:57:49.025750 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.026085 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m19:57:49.026815 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m19:57:49.028308 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_analytics"."fact_sales__dbt_backup"
[0m19:57:49.028748 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m19:57:49.029024 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
drop table if exists "primary_app_db"."public_analytics"."fact_sales__dbt_backup" cascade
[0m19:57:49.030108 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:57:49.031081 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m19:57:49.031644 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_analytics.fact_sales .................. [[32mSELECT 0[0m in 0.03s]
[0m19:57:49.032172 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m19:57:49.033306 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:49.033634 [debug] [MainThread]: On master: BEGIN
[0m19:57:49.033945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:49.038856 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:57:49.039137 [debug] [MainThread]: On master: COMMIT
[0m19:57:49.039381 [debug] [MainThread]: Using postgres connection "master"
[0m19:57:49.039618 [debug] [MainThread]: On master: COMMIT
[0m19:57:49.039896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:57:49.040136 [debug] [MainThread]: On master: Close
[0m19:57:49.040453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:49.040688 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m19:57:49.040900 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m19:57:49.041166 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m19:57:49.041447 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m19:57:49.041975 [info ] [MainThread]: 
[0m19:57:49.042312 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m19:57:49.043499 [debug] [MainThread]: Command end result
[0m19:57:49.063357 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m19:57:49.064805 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m19:57:49.070126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m19:57:49.070407 [info ] [MainThread]: 
[0m19:57:49.070758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:49.071037 [info ] [MainThread]: 
[0m19:57:49.071413 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:57:49.072651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8056567, "process_in_blocks": "0", "process_kernel_time": 0.121578, "process_mem_max_rss": "132684", "process_out_blocks": "2634", "process_user_time": 2.680766}
[0m19:57:49.073202 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:49.073096 after 1.81 seconds
[0m19:57:49.073521 [debug] [MainThread]: Flushing usage events


============================== 20:03:09.358078 | 7eac988b-a36b-40c3-a335-623c492294aa ==============================
[0m20:03:09.358078 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:03:09.367993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --target prod', 'send_anonymous_usage_stats': 'False'}
[0m20:03:09.369329 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:03:09.376973 [info ] [MainThread]: dbt version: 1.9.0
[0m20:03:09.377471 [info ] [MainThread]: python version: 3.12.4
[0m20:03:09.377799 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:03:09.378084 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m20:03:09.431725 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m20:03:09.432222 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m20:03:09.432580 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m20:03:09.433032 [info ] [MainThread]: adapter type: postgres
[0m20:03:09.433360 [info ] [MainThread]: adapter version: 1.9.0
[0m20:03:09.511837 [info ] [MainThread]: Configuration:
[0m20:03:09.512268 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:03:09.512594 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:03:09.512856 [info ] [MainThread]: Required dependencies:
[0m20:03:09.513330 [debug] [MainThread]: Executing "git --help"
[0m20:03:09.531186 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:03:09.531820 [debug] [MainThread]: STDERR: "b''"
[0m20:03:09.532134 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:03:09.532454 [info ] [MainThread]: Connection:
[0m20:03:09.532761 [info ] [MainThread]:   host: db
[0m20:03:09.533063 [info ] [MainThread]:   port: 5432
[0m20:03:09.533345 [info ] [MainThread]:   user: prod_app_user_2025
[0m20:03:09.533666 [info ] [MainThread]:   database: primary_app_db
[0m20:03:09.533927 [info ] [MainThread]:   schema: public
[0m20:03:09.534179 [info ] [MainThread]:   connect_timeout: 10
[0m20:03:09.534460 [info ] [MainThread]:   role: None
[0m20:03:09.534736 [info ] [MainThread]:   search_path: None
[0m20:03:09.535004 [info ] [MainThread]:   keepalives_idle: 0
[0m20:03:09.535270 [info ] [MainThread]:   sslmode: None
[0m20:03:09.535566 [info ] [MainThread]:   sslcert: None
[0m20:03:09.535848 [info ] [MainThread]:   sslkey: None
[0m20:03:09.536110 [info ] [MainThread]:   sslrootcert: None
[0m20:03:09.536375 [info ] [MainThread]:   application_name: dbt
[0m20:03:09.536640 [info ] [MainThread]:   retries: 1
[0m20:03:09.537086 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:03:09.588723 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:03:09.627846 [debug] [MainThread]: Using postgres connection "debug"
[0m20:03:09.628386 [debug] [MainThread]: On debug: select 1 as id
[0m20:03:09.628728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:09.674340 [debug] [MainThread]: SQL status: SELECT 1 in 0.045 seconds
[0m20:03:09.675706 [debug] [MainThread]: On debug: Close
[0m20:03:09.676173 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:03:09.676647 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:03:09.680121 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39026472, "process_in_blocks": "0", "process_kernel_time": 0.166337, "process_mem_max_rss": "119592", "process_out_blocks": "12", "process_user_time": 1.265567}
[0m20:03:09.680673 [debug] [MainThread]: Command `dbt debug` succeeded at 20:03:09.680575 after 0.39 seconds
[0m20:03:09.680987 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:03:09.681381 [debug] [MainThread]: Flushing usage events


============================== 20:03:10.956597 | 8d173e71-e0e8-427c-bd3b-ca90367f2a3d ==============================
[0m20:03:10.956597 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:03:10.964801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m20:03:10.965526 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:03:11.176248 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:03:11.232110 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m20:03:11.323460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:03:11.323881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:03:11.417030 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m20:03:11.420422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m20:03:11.438047 [info ] [MainThread]: Found 5 models, 3 sources, 429 macros
[0m20:03:11.440408 [info ] [MainThread]: 
[0m20:03:11.441331 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m20:03:11.441774 [info ] [MainThread]: 
[0m20:03:11.442452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:03:11.447610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m20:03:11.448349 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m20:03:11.482472 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m20:03:11.482853 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m20:03:11.483640 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m20:03:11.483249 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m20:03:11.483959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:11.484238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:11.541050 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.056 seconds
[0m20:03:11.541452 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.057 seconds
[0m20:03:11.544083 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m20:03:11.543028 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m20:03:11.546720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m20:03:11.547145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m20:03:11.551613 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m20:03:11.552905 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m20:03:11.553250 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m20:03:11.553576 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m20:03:11.553880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:11.554159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:03:11.559830 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:03:11.560164 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m20:03:11.560394 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:03:11.560690 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m20:03:11.561015 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m20:03:11.561504 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m20:03:11.563722 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m20:03:11.563942 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m20:03:11.565043 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m20:03:11.566096 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m20:03:11.566554 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m20:03:11.566816 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m20:03:11.571718 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.572049 [debug] [MainThread]: On master: BEGIN
[0m20:03:11.572339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:03:11.577614 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:03:11.577921 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.578318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:03:11.581744 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m20:03:11.583018 [debug] [MainThread]: On master: ROLLBACK
[0m20:03:11.583387 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.583653 [debug] [MainThread]: On master: BEGIN
[0m20:03:11.584036 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:03:11.584314 [debug] [MainThread]: On master: COMMIT
[0m20:03:11.584589 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.584852 [debug] [MainThread]: On master: COMMIT
[0m20:03:11.585170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:03:11.585446 [debug] [MainThread]: On master: Close
[0m20:03:11.587446 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m20:03:11.587728 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m20:03:11.588012 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m20:03:11.588484 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m20:03:11.589810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m20:03:11.589428 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m20:03:11.588944 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m20:03:11.590128 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m20:03:11.590574 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m20:03:11.590896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m20:03:11.596538 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m20:03:11.596926 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m20:03:11.597254 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m20:03:11.599556 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m20:03:11.601653 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m20:03:11.602580 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m20:03:11.609607 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m20:03:11.630473 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m20:03:11.635327 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m20:03:11.636039 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m20:03:11.638246 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m20:03:11.640005 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.640283 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.640673 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.640900 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m20:03:11.641225 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m20:03:11.641586 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m20:03:11.641972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:11.642325 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:03:11.642610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:03:11.648607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:03:11.648899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:03:11.649229 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.649641 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.650022 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m20:03:11.650482 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m20:03:11.650779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:03:11.651327 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.651717 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m20:03:11.653271 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:03:11.653589 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:03:11.653846 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:03:11.658734 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.660901 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.662879 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.664046 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:03:11.663700 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m20:03:11.663265 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m20:03:11.664679 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.667080 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.665193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:03:11.664937 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.667398 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:03:11.669360 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.671221 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.671660 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m20:03:11.671931 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.672206 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:03:11.679434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:03:11.685049 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m20:03:11.686367 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m20:03:11.686649 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:03:11.686953 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.687333 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.689187 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m20:03:11.689561 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m20:03:11.689941 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m20:03:11.690302 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.690885 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m20:03:11.691182 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:03:11.691464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:03:11.696473 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m20:03:11.696744 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m20:03:11.698209 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m20:03:11.702130 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m20:03:11.704605 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m20:03:11.704252 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m20:03:11.703661 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m20:03:11.705044 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m20:03:11.705576 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m20:03:11.705845 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:03:11.706260 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m20:03:11.708257 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m20:03:11.708526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:03:11.709961 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:03:11.711079 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m20:03:11.711546 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:03:11.712586 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m20:03:11.713159 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.12s]
[0m20:03:11.713830 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m20:03:11.714389 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:03:11.714877 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m20:03:11.715456 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m20:03:11.716833 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m20:03:11.717226 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m20:03:11.717658 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m20:03:11.717982 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m20:03:11.720517 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m20:03:11.721401 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m20:03:11.737579 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m20:03:11.738682 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.738992 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m20:03:11.739274 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:03:11.745079 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m20:03:11.745386 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.745697 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m20:03:11.748622 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m20:03:11.751096 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.751394 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m20:03:11.751871 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.753820 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.754105 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m20:03:11.754536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.758373 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m20:03:11.758661 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.758910 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m20:03:11.759564 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m20:03:11.761035 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m20:03:11.763135 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m20:03:11.763515 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m20:03:11.766172 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:03:11.767169 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m20:03:11.767778 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m20:03:11.768254 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m20:03:11.768924 [debug] [Thread-1 (]: Began running node model.data_models.fact_sales
[0m20:03:11.769321 [info ] [Thread-1 (]: 5 of 5 START sql table model public_analytics.fact_sales ....................... [RUN]
[0m20:03:11.769670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_models.stg_order_items, now model.data_models.fact_sales)
[0m20:03:11.769955 [debug] [Thread-1 (]: Began compiling node model.data_models.fact_sales
[0m20:03:11.772673 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m20:03:11.773361 [debug] [Thread-1 (]: Began executing node model.data_models.fact_sales
[0m20:03:11.775446 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m20:03:11.776046 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.776335 [debug] [Thread-1 (]: On model.data_models.fact_sales: BEGIN
[0m20:03:11.776597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:11.781679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:03:11.781968 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.782347 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

  
    

  create  table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()
  );
  
[0m20:03:11.786974 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:03:11.790528 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.790865 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales" rename to "fact_sales__dbt_backup"
[0m20:03:11.791452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.793373 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.793686 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m20:03:11.794148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:03:11.795322 [debug] [Thread-1 (]: On model.data_models.fact_sales: COMMIT
[0m20:03:11.795615 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.795880 [debug] [Thread-1 (]: On model.data_models.fact_sales: COMMIT
[0m20:03:11.796488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m20:03:11.798282 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_analytics"."fact_sales__dbt_backup"
[0m20:03:11.798823 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m20:03:11.799156 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
drop table if exists "primary_app_db"."public_analytics"."fact_sales__dbt_backup" cascade
[0m20:03:11.800492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:03:11.801468 [debug] [Thread-1 (]: On model.data_models.fact_sales: Close
[0m20:03:11.802052 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_analytics.fact_sales .................. [[32mSELECT 0[0m in 0.03s]
[0m20:03:11.802582 [debug] [Thread-1 (]: Finished running node model.data_models.fact_sales
[0m20:03:11.803685 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.804003 [debug] [MainThread]: On master: BEGIN
[0m20:03:11.804299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:03:11.809543 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:03:11.809890 [debug] [MainThread]: On master: COMMIT
[0m20:03:11.810148 [debug] [MainThread]: Using postgres connection "master"
[0m20:03:11.810404 [debug] [MainThread]: On master: COMMIT
[0m20:03:11.810696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:03:11.810929 [debug] [MainThread]: On master: Close
[0m20:03:11.811275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:11.811560 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m20:03:11.811812 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m20:03:11.812045 [debug] [MainThread]: Connection 'model.data_models.stg_products' was properly closed.
[0m20:03:11.812279 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m20:03:11.812879 [info ] [MainThread]: 
[0m20:03:11.813230 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:03:11.814466 [debug] [MainThread]: Command end result
[0m20:03:11.834367 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m20:03:11.835980 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m20:03:11.841626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m20:03:11.841922 [info ] [MainThread]: 
[0m20:03:11.842314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:11.842616 [info ] [MainThread]: 
[0m20:03:11.842997 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:03:11.844377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97261226, "process_in_blocks": "0", "process_kernel_time": 0.112748, "process_mem_max_rss": "127032", "process_out_blocks": "1798", "process_user_time": 1.909674}
[0m20:03:11.844933 [debug] [MainThread]: Command `dbt run` succeeded at 20:03:11.844832 after 0.97 seconds
[0m20:03:11.845266 [debug] [MainThread]: Flushing usage events


============================== 21:31:34.053862 | 8c7bc2a5-5d47-4039-9120-904301633bf9 ==============================
[0m21:31:34.053862 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:31:34.065321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m21:31:34.065967 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:31:34.091402 [info ] [MainThread]: dbt version: 1.9.0
[0m21:31:34.091981 [info ] [MainThread]: python version: 3.12.4
[0m21:31:34.092447 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:31:34.092807 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m21:31:34.143484 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m21:31:34.143981 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m21:31:34.144354 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m21:31:34.144841 [info ] [MainThread]: adapter type: postgres
[0m21:31:34.145214 [info ] [MainThread]: adapter version: 1.9.0
[0m21:31:34.224105 [info ] [MainThread]: Configuration:
[0m21:31:34.224624 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:31:34.225018 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:31:34.225358 [info ] [MainThread]: Required dependencies:
[0m21:31:34.225881 [debug] [MainThread]: Executing "git --help"
[0m21:31:34.244921 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:31:34.245545 [debug] [MainThread]: STDERR: "b''"
[0m21:31:34.245861 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:31:34.246200 [info ] [MainThread]: Connection:
[0m21:31:34.246628 [info ] [MainThread]:   host: db
[0m21:31:34.246978 [info ] [MainThread]:   port: 5432
[0m21:31:34.247345 [info ] [MainThread]:   user: prod_app_user_2025
[0m21:31:34.247731 [info ] [MainThread]:   database: primary_app_db
[0m21:31:34.248063 [info ] [MainThread]:   schema: public
[0m21:31:34.248463 [info ] [MainThread]:   connect_timeout: 10
[0m21:31:34.248830 [info ] [MainThread]:   role: None
[0m21:31:34.249137 [info ] [MainThread]:   search_path: None
[0m21:31:34.249499 [info ] [MainThread]:   keepalives_idle: 0
[0m21:31:34.249858 [info ] [MainThread]:   sslmode: None
[0m21:31:34.250183 [info ] [MainThread]:   sslcert: None
[0m21:31:34.250499 [info ] [MainThread]:   sslkey: None
[0m21:31:34.250884 [info ] [MainThread]:   sslrootcert: None
[0m21:31:34.251210 [info ] [MainThread]:   application_name: dbt
[0m21:31:34.251618 [info ] [MainThread]:   retries: 1
[0m21:31:34.252142 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:34.301737 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:31:34.328210 [debug] [MainThread]: Using postgres connection "debug"
[0m21:31:34.330459 [debug] [MainThread]: On debug: select 1 as id
[0m21:31:34.332507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:34.373781 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m21:31:34.375078 [debug] [MainThread]: On debug: Close
[0m21:31:34.375550 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:31:34.375992 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:31:34.379464 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.37419096, "process_in_blocks": "0", "process_kernel_time": 0.11579, "process_mem_max_rss": "119708", "process_out_blocks": "1500", "process_user_time": 1.285675}
[0m21:31:34.380041 [debug] [MainThread]: Command `dbt debug` succeeded at 21:31:34.379931 after 0.38 seconds
[0m21:31:34.380405 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:31:34.380791 [debug] [MainThread]: Flushing usage events


============================== 21:31:35.521139 | e65b370c-a8e0-4225-bf44-198a90e71f10 ==============================
[0m21:31:35.521139 [info ] [MainThread]: Running with dbt=1.9.0
[0m21:31:35.528390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target prod', 'send_anonymous_usage_stats': 'False'}
[0m21:31:35.529046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:31:35.708365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:35.763404 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m21:31:35.856181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:35.856586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:35.948988 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m21:31:35.951698 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m21:31:35.976393 [info ] [MainThread]: Found 5 models, 3 sources, 429 macros
[0m21:31:35.978395 [info ] [MainThread]: 
[0m21:31:35.978877 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m21:31:35.979310 [info ] [MainThread]: 
[0m21:31:35.979972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:31:35.984712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m21:31:35.985449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m21:31:36.013781 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m21:31:36.014563 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m21:31:36.014202 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m21:31:36.015184 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m21:31:36.014884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:36.015472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:36.069839 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m21:31:36.070173 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m21:31:36.071752 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m21:31:36.072835 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m21:31:36.073918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_staging)
[0m21:31:36.074215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_analytics)
[0m21:31:36.074862 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_staging"
"
[0m21:31:36.075271 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_analytics"
"
[0m21:31:36.079222 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m21:31:36.080751 [debug] [ThreadPool]: On create_primary_app_db_public_staging: BEGIN
[0m21:31:36.080482 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m21:31:36.081018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:36.081274 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: BEGIN
[0m21:31:36.081776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:36.088902 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:31:36.089250 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m21:31:36.089732 [debug] [ThreadPool]: On create_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_staging"} */
create schema if not exists "public_staging"
[0m21:31:36.089548 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:31:36.090090 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m21:31:36.090535 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m21:31:36.090292 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:31:36.091436 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m21:31:36.091633 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:31:36.091889 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m21:31:36.092975 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m21:31:36.092651 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m21:31:36.093407 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m21:31:36.093847 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m21:31:36.093626 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:31:36.094246 [debug] [ThreadPool]: On create_primary_app_db_public_staging: Close
[0m21:31:36.094460 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:31:36.094950 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: Close
[0m21:31:36.097022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_analytics, now list_primary_app_db_public_staging)
[0m21:31:36.097398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_staging, now list_primary_app_db_public_analytics)
[0m21:31:36.101604 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m21:31:36.102851 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m21:31:36.103167 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m21:31:36.103468 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m21:31:36.103766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:36.104064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:36.109081 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.109310 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.109568 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m21:31:36.109868 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m21:31:36.110209 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m21:31:36.110572 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m21:31:36.112693 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:31:36.112893 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:31:36.113905 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m21:31:36.114891 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m21:31:36.115350 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m21:31:36.115638 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m21:31:36.119638 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.119977 [debug] [MainThread]: On master: BEGIN
[0m21:31:36.120249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:36.125315 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.125671 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.126097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:31:36.128622 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m21:31:36.129867 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:36.130253 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.130561 [debug] [MainThread]: On master: BEGIN
[0m21:31:36.130971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:31:36.131279 [debug] [MainThread]: On master: COMMIT
[0m21:31:36.131590 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.131892 [debug] [MainThread]: On master: COMMIT
[0m21:31:36.132265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:36.132576 [debug] [MainThread]: On master: Close
[0m21:31:36.134584 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m21:31:36.134883 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m21:31:36.135163 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m21:31:36.135670 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m21:31:36.136195 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m21:31:36.136816 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m21:31:36.137308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_order_items)
[0m21:31:36.137686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_orders)
[0m21:31:36.138210 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m21:31:36.138591 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m21:31:36.138931 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m21:31:36.139272 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m21:31:36.144923 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m21:31:36.147829 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m21:31:36.149955 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m21:31:36.151892 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m21:31:36.158290 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m21:31:36.158556 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m21:31:36.178992 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m21:31:36.181144 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m21:31:36.183188 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m21:31:36.185031 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m21:31:36.185363 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m21:31:36.185609 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m21:31:36.185869 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m21:31:36.186734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:31:36.186462 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m21:31:36.186170 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m21:31:36.187189 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:31:36.187748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:36.192138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.192551 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m21:31:36.192811 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m21:31:36.193122 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m21:31:36.193476 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m21:31:36.193984 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m21:31:36.194514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:31:36.195039 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m21:31:36.194787 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:31:36.195321 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m21:31:36.195606 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:31:36.200920 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m21:31:36.203170 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m21:31:36.203452 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:31:36.203748 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:31:36.204110 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:31:36.206137 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m21:31:36.207405 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m21:31:36.207098 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:36.206739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:36.214531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:31:36.219969 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m21:31:36.221187 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m21:31:36.222918 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m21:31:36.222600 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m21:31:36.222196 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m21:31:36.223974 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m21:31:36.223670 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m21:31:36.223244 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m21:31:36.224318 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m21:31:36.225624 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:31:36.226162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:31:36.225944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:31:36.231019 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m21:31:36.233206 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m21:31:36.238892 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m21:31:36.238365 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m21:31:36.234655 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m21:31:36.240111 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m21:31:36.239610 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m21:31:36.239226 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m21:31:36.240446 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m21:31:36.241006 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:31:36.241292 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:31:36.241656 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:31:36.243490 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m21:31:36.244601 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m21:31:36.245643 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m21:31:36.247274 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:31:36.248049 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:31:36.250011 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m21:31:36.249511 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m21:31:36.248673 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.11s]
[0m21:31:36.250755 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m21:31:36.251202 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m21:31:36.251628 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m21:31:36.252313 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m21:31:36.252655 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m21:31:36.254987 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m21:31:36.257133 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m21:31:36.273713 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m21:31:36.275034 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m21:31:36.275384 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m21:31:36.275655 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:31:36.280986 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.281350 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m21:31:36.281691 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m21:31:36.284232 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m21:31:36.286510 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m21:31:36.286803 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m21:31:36.287229 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:36.291110 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m21:31:36.291415 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m21:31:36.291712 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m21:31:36.292346 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m21:31:36.293853 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m21:31:36.295948 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m21:31:36.296274 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m21:31:36.296666 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:31:36.297676 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m21:31:36.298274 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m21:31:36.298979 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m21:31:36.300323 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m21:31:36.300747 [info ] [Thread-3 (]: 5 of 5 START sql table model public_analytics.fact_sales ....................... [RUN]
[0m21:31:36.301196 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m21:31:36.301574 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m21:31:36.304390 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m21:31:36.306046 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m21:31:36.308243 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m21:31:36.308884 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m21:31:36.309152 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m21:31:36.309409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:31:36.314328 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:31:36.314624 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m21:31:36.315001 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

  
    

  create  table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()
  );
  
[0m21:31:36.330492 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m21:31:36.332746 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m21:31:36.333047 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m21:31:36.333465 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:31:36.334613 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m21:31:36.334910 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m21:31:36.335175 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m21:31:36.336011 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:31:36.337493 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_analytics"."fact_sales__dbt_backup"
[0m21:31:36.338735 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m21:31:36.339017 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
drop table if exists "primary_app_db"."public_analytics"."fact_sales__dbt_backup" cascade
[0m21:31:36.339422 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:31:36.340427 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m21:31:36.341028 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_analytics.fact_sales .................. [[32mSELECT 0[0m in 0.04s]
[0m21:31:36.341572 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m21:31:36.342741 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.343071 [debug] [MainThread]: On master: BEGIN
[0m21:31:36.343360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:36.352143 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:31:36.352801 [debug] [MainThread]: On master: COMMIT
[0m21:31:36.353494 [debug] [MainThread]: Using postgres connection "master"
[0m21:31:36.353761 [debug] [MainThread]: On master: COMMIT
[0m21:31:36.354071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:31:36.354369 [debug] [MainThread]: On master: Close
[0m21:31:36.354780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:36.355026 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m21:31:36.355323 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m21:31:36.355612 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m21:31:36.355846 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m21:31:36.356379 [info ] [MainThread]: 
[0m21:31:36.356706 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:31:36.357939 [debug] [MainThread]: Command end result
[0m21:31:36.378186 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m21:31:36.379719 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m21:31:36.385542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m21:31:36.385816 [info ] [MainThread]: 
[0m21:31:36.386246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:36.386645 [info ] [MainThread]: 
[0m21:31:36.387109 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:31:36.388592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9342399, "process_in_blocks": "0", "process_kernel_time": 0.107018, "process_mem_max_rss": "129580", "process_out_blocks": "1912", "process_user_time": 1.733299}
[0m21:31:36.389097 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:36.389000 after 0.94 seconds
[0m21:31:36.389438 [debug] [MainThread]: Flushing usage events


============================== 13:24:30.357062 | 2b915142-8112-49dc-af6d-3127fdb380ab ==============================
[0m13:24:30.357062 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:24:30.368826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --target prod', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:24:30.369444 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:24:30.394390 [info ] [MainThread]: dbt version: 1.9.0
[0m13:24:30.394841 [info ] [MainThread]: python version: 3.12.4
[0m13:24:30.395247 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:24:30.395572 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m13:24:30.448593 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m13:24:30.449108 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m13:24:30.449451 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m13:24:30.449883 [info ] [MainThread]: adapter type: postgres
[0m13:24:30.450217 [info ] [MainThread]: adapter version: 1.9.0
[0m13:24:30.534834 [info ] [MainThread]: Configuration:
[0m13:24:30.535487 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:24:30.535874 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:24:30.536198 [info ] [MainThread]: Required dependencies:
[0m13:24:30.536677 [debug] [MainThread]: Executing "git --help"
[0m13:24:30.554247 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:24:30.554854 [debug] [MainThread]: STDERR: "b''"
[0m13:24:30.555224 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:24:30.555596 [info ] [MainThread]: Connection:
[0m13:24:30.555943 [info ] [MainThread]:   host: db
[0m13:24:30.556258 [info ] [MainThread]:   port: 5432
[0m13:24:30.556556 [info ] [MainThread]:   user: prod_app_user_2025
[0m13:24:30.556871 [info ] [MainThread]:   database: primary_app_db
[0m13:24:30.557180 [info ] [MainThread]:   schema: public
[0m13:24:30.557462 [info ] [MainThread]:   connect_timeout: 10
[0m13:24:30.557742 [info ] [MainThread]:   role: None
[0m13:24:30.558041 [info ] [MainThread]:   search_path: None
[0m13:24:30.558335 [info ] [MainThread]:   keepalives_idle: 0
[0m13:24:30.558582 [info ] [MainThread]:   sslmode: None
[0m13:24:30.558825 [info ] [MainThread]:   sslcert: None
[0m13:24:30.559101 [info ] [MainThread]:   sslkey: None
[0m13:24:30.559388 [info ] [MainThread]:   sslrootcert: None
[0m13:24:30.559653 [info ] [MainThread]:   application_name: dbt
[0m13:24:30.559895 [info ] [MainThread]:   retries: 1
[0m13:24:30.560349 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:30.613131 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:24:30.641748 [debug] [MainThread]: Using postgres connection "debug"
[0m13:24:30.642217 [debug] [MainThread]: On debug: select 1 as id
[0m13:24:30.642523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:30.689369 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m13:24:30.690848 [debug] [MainThread]: On debug: Close
[0m13:24:30.691372 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:24:30.691847 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:24:30.695109 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.38850418, "process_in_blocks": "0", "process_kernel_time": 0.105961, "process_mem_max_rss": "120064", "process_out_blocks": "1500", "process_user_time": 1.318515}
[0m13:24:30.695657 [debug] [MainThread]: Command `dbt debug` succeeded at 13:24:30.695552 after 0.39 seconds
[0m13:24:30.695994 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:24:30.696369 [debug] [MainThread]: Flushing usage events


============================== 13:24:31.818708 | 5a5f1500-3e2e-4d79-8929-e61fe75bb222 ==============================
[0m13:24:31.818708 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:24:31.825863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:24:31.826508 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:24:32.017987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:32.072666 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m13:24:32.164505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:32.164920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:32.255925 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:24:32.258700 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:24:32.281631 [info ] [MainThread]: Found 5 models, 3 sources, 429 macros
[0m13:24:32.283413 [info ] [MainThread]: 
[0m13:24:32.283786 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:24:32.284113 [info ] [MainThread]: 
[0m13:24:32.284674 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:32.289337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m13:24:32.290050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m13:24:32.317898 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m13:24:32.318599 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m13:24:32.318210 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m13:24:32.319203 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m13:24:32.318900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:32.319486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:32.371435 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m13:24:32.371775 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.053 seconds
[0m13:24:32.373283 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m13:24:32.374270 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m13:24:32.376798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m13:24:32.377173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m13:24:32.381607 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m13:24:32.382882 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m13:24:32.383218 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m13:24:32.383500 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m13:24:32.383797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:32.384118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:32.389647 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:24:32.389882 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:24:32.390139 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m13:24:32.390442 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m13:24:32.390772 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m13:24:32.391132 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:24:32.393568 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m13:24:32.393768 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m13:24:32.394824 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m13:24:32.395934 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m13:24:32.396380 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m13:24:32.396624 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m13:24:32.401547 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.401874 [debug] [MainThread]: On master: BEGIN
[0m13:24:32.402178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:32.406993 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:24:32.407280 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.407658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:32.411160 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m13:24:32.412531 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:32.412869 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.413128 [debug] [MainThread]: On master: BEGIN
[0m13:24:32.413474 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:24:32.413730 [debug] [MainThread]: On master: COMMIT
[0m13:24:32.413972 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.414204 [debug] [MainThread]: On master: COMMIT
[0m13:24:32.414521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:32.414801 [debug] [MainThread]: On master: Close
[0m13:24:32.416693 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m13:24:32.416981 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m13:24:32.417238 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m13:24:32.417708 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m13:24:32.418237 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m13:24:32.418678 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m13:24:32.419082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m13:24:32.419428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m13:24:32.419861 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m13:24:32.420218 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m13:24:32.420518 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m13:24:32.420843 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m13:24:32.426417 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m13:24:32.428464 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m13:24:32.430580 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m13:24:32.433113 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m13:24:32.433368 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m13:24:32.433625 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m13:24:32.465907 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m13:24:32.466395 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m13:24:32.468628 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m13:24:32.471062 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.471362 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.471654 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.471905 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m13:24:32.472235 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m13:24:32.472608 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m13:24:32.472941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:24:32.473255 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:24:32.473616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:32.480815 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m13:24:32.481352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:24:32.482238 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.483248 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.483787 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m13:24:32.484323 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m13:24:32.484941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m13:24:32.485474 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.485966 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m13:24:32.488380 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:24:32.488661 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:24:32.488896 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:24:32.494384 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.496528 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.498587 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.499655 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m13:24:32.499311 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m13:24:32.498907 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:24:32.500308 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.500580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.502745 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.505451 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:24:32.505117 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.503047 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:24:32.505926 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m13:24:32.506215 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.508203 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.514894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:24:32.521495 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m13:24:32.523431 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.523078 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m13:24:32.521752 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:24:32.523778 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m13:24:32.524323 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.524901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.525154 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m13:24:32.526262 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m13:24:32.526707 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.527010 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m13:24:32.530831 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m13:24:32.531085 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m13:24:32.531335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:24:32.536903 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m13:24:32.538531 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m13:24:32.540070 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m13:24:32.544007 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m13:24:32.545383 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m13:24:32.545068 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m13:24:32.544564 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m13:24:32.545843 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m13:24:32.546195 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m13:24:32.548187 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:24:32.550557 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m13:24:32.548700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:24:32.548446 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:24:32.552645 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m13:24:32.553163 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:24:32.554245 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m13:24:32.554883 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.14s]
[0m13:24:32.555552 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m13:24:32.556206 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m13:24:32.556726 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m13:24:32.557384 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m13:24:32.557786 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m13:24:32.558403 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m13:24:32.559018 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m13:24:32.559345 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m13:24:32.561848 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m13:24:32.563158 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m13:24:32.580007 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m13:24:32.581252 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.581586 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m13:24:32.581883 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:24:32.587156 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:32.587455 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.587774 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m13:24:32.590505 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m13:24:32.592795 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.593127 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m13:24:32.593624 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.595713 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.596017 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:24:32.596442 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.600325 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m13:24:32.600612 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.600898 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m13:24:32.601412 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m13:24:32.602966 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m13:24:32.604983 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m13:24:32.605283 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m13:24:32.606646 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:24:32.607661 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m13:24:32.608245 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m13:24:32.608736 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m13:24:32.610054 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m13:24:32.610416 [info ] [Thread-3 (]: 5 of 5 START sql table model public_analytics.fact_sales ....................... [RUN]
[0m13:24:32.610787 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m13:24:32.611084 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m13:24:32.613810 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m13:24:32.614641 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m13:24:32.616764 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m13:24:32.617399 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.617663 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m13:24:32.617911 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:24:32.622999 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m13:24:32.623310 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.623664 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

  
    

  create  table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()
  );
  
[0m13:24:32.627618 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m13:24:32.630541 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.630823 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales" rename to "fact_sales__dbt_backup"
[0m13:24:32.631247 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.633093 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.633405 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
alter table "primary_app_db"."public_analytics"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:24:32.633825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:24:32.635025 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m13:24:32.635303 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.635559 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m13:24:32.636026 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m13:24:32.637534 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_analytics"."fact_sales__dbt_backup"
[0m13:24:32.637992 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m13:24:32.638292 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */
drop table if exists "primary_app_db"."public_analytics"."fact_sales__dbt_backup" cascade
[0m13:24:32.639396 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:24:32.640412 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m13:24:32.641023 [info ] [Thread-3 (]: 5 of 5 OK created sql table model public_analytics.fact_sales .................. [[32mSELECT 0[0m in 0.03s]
[0m13:24:32.641550 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m13:24:32.642686 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.643001 [debug] [MainThread]: On master: BEGIN
[0m13:24:32.643245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:32.648124 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:24:32.648423 [debug] [MainThread]: On master: COMMIT
[0m13:24:32.648673 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:32.648937 [debug] [MainThread]: On master: COMMIT
[0m13:24:32.649264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:32.649508 [debug] [MainThread]: On master: Close
[0m13:24:32.649836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:32.650100 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m13:24:32.650318 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m13:24:32.650527 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m13:24:32.650734 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m13:24:32.651204 [info ] [MainThread]: 
[0m13:24:32.651522 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:24:32.652660 [debug] [MainThread]: Command end result
[0m13:24:32.672327 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:24:32.673716 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:24:32.679454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:24:32.679743 [info ] [MainThread]: 
[0m13:24:32.680157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:32.680454 [info ] [MainThread]: 
[0m13:24:32.680820 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:24:32.682093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9298619, "process_in_blocks": "0", "process_kernel_time": 0.096445, "process_mem_max_rss": "126892", "process_out_blocks": "1911", "process_user_time": 1.743048}
[0m13:24:32.682652 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:32.682529 after 0.93 seconds
[0m13:24:32.683217 [debug] [MainThread]: Flushing usage events


============================== 14:40:36.293089 | acc640bd-1c55-4b6c-acfd-790bcc102cbd ==============================
[0m14:40:36.293089 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:40:36.303553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --target prod', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:40:36.304176 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:40:36.330309 [info ] [MainThread]: dbt version: 1.9.0
[0m14:40:36.330786 [info ] [MainThread]: python version: 3.12.4
[0m14:40:36.331126 [info ] [MainThread]: python path: /usr/local/bin/python
[0m14:40:36.331424 [info ] [MainThread]: os info: Linux-6.12.5-linuxkit-x86_64-with-glibc2.31
[0m14:40:36.380992 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m14:40:36.381450 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m14:40:36.381780 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m14:40:36.382210 [info ] [MainThread]: adapter type: postgres
[0m14:40:36.382502 [info ] [MainThread]: adapter version: 1.9.0
[0m14:40:36.465938 [info ] [MainThread]: Configuration:
[0m14:40:36.466388 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:40:36.466730 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:40:36.467049 [info ] [MainThread]: Required dependencies:
[0m14:40:36.467526 [debug] [MainThread]: Executing "git --help"
[0m14:40:36.485020 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:40:36.485725 [debug] [MainThread]: STDERR: "b''"
[0m14:40:36.486111 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:40:36.486458 [info ] [MainThread]: Connection:
[0m14:40:36.486789 [info ] [MainThread]:   host: db
[0m14:40:36.487131 [info ] [MainThread]:   port: 5432
[0m14:40:36.487473 [info ] [MainThread]:   user: prod_app_user_2025
[0m14:40:36.487801 [info ] [MainThread]:   database: primary_app_db
[0m14:40:36.488110 [info ] [MainThread]:   schema: public
[0m14:40:36.488411 [info ] [MainThread]:   connect_timeout: 10
[0m14:40:36.488705 [info ] [MainThread]:   role: None
[0m14:40:36.488999 [info ] [MainThread]:   search_path: None
[0m14:40:36.489273 [info ] [MainThread]:   keepalives_idle: 0
[0m14:40:36.489569 [info ] [MainThread]:   sslmode: None
[0m14:40:36.489874 [info ] [MainThread]:   sslcert: None
[0m14:40:36.490161 [info ] [MainThread]:   sslkey: None
[0m14:40:36.490443 [info ] [MainThread]:   sslrootcert: None
[0m14:40:36.490695 [info ] [MainThread]:   application_name: dbt
[0m14:40:36.490953 [info ] [MainThread]:   retries: 1
[0m14:40:36.491436 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:40:36.555058 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:40:36.607778 [debug] [MainThread]: Using postgres connection "debug"
[0m14:40:36.609063 [debug] [MainThread]: On debug: select 1 as id
[0m14:40:36.609416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:36.655222 [debug] [MainThread]: SQL status: SELECT 1 in 0.045 seconds
[0m14:40:36.656535 [debug] [MainThread]: On debug: Close
[0m14:40:36.657028 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:40:36.657525 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:40:36.660715 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41827446, "process_in_blocks": "0", "process_kernel_time": 0.109051, "process_mem_max_rss": "119768", "process_out_blocks": "1500", "process_user_time": 1.351632}
[0m14:40:36.661361 [debug] [MainThread]: Command `dbt debug` succeeded at 14:40:36.661240 after 0.42 seconds
[0m14:40:36.661717 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:40:36.662111 [debug] [MainThread]: Flushing usage events


============================== 14:40:37.804080 | a7603fb4-4b69-4ea0-a374-d007c9836ab6 ==============================
[0m14:40:37.804080 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:40:37.811109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --target prod', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m14:40:37.811728 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:40:38.037909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:40:38.088666 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:40:38.091161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.355639, "process_in_blocks": "0", "process_kernel_time": 0.071065, "process_mem_max_rss": "108712", "process_out_blocks": "2", "process_user_time": 1.202107}
[0m14:40:38.091758 [debug] [MainThread]: Command `dbt run` failed at 14:40:38.091636 after 0.36 seconds
[0m14:40:38.092382 [debug] [MainThread]: Flushing usage events


============================== 14:41:25.793644 | f8d0c900-74bb-4598-88fa-e03953e91f5e ==============================
[0m14:41:25.793644 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:41:25.804914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --target prod', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:41:25.805533 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:41:25.912372 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6s7gkm15'
[0m14:41:25.912859 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:41:26.012527 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:41:26.014129 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:41:26.041989 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:41:26.052955 [info ] [MainThread]: Updating lock file in file path: /usr/app/dbt_project/package-lock.yml
[0m14:41:26.054780 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8flpt103'
[0m14:41:26.058192 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:41:26.385097 [info ] [MainThread]: Installed from version 1.1.1
[0m14:41:26.385701 [info ] [MainThread]: Updated version available: 1.3.1
[0m14:41:26.386150 [info ] [MainThread]: 
[0m14:41:26.386659 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:41:26.389288 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6448211, "process_in_blocks": "0", "process_kernel_time": 0.111392, "process_mem_max_rss": "107812", "process_out_blocks": "2205", "process_user_time": 1.219352}
[0m14:41:26.389888 [debug] [MainThread]: Command `dbt deps` succeeded at 14:41:26.389763 after 0.65 seconds
[0m14:41:26.390218 [debug] [MainThread]: Flushing usage events


============================== 14:41:27.722133 | 76ac29b8-4762-43b7-b403-5d00b2a336c4 ==============================
[0m14:41:27.722133 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:41:27.729280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m14:41:27.729908 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:41:27.928494 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:27.998767 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:41:28.076133 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:41:29.505007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:41:29.507825 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:41:29.532024 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:41:29.534169 [info ] [MainThread]: 
[0m14:41:29.534531 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:41:29.534845 [info ] [MainThread]: 
[0m14:41:29.535427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:29.539862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:41:29.540559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:41:29.580189 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:41:29.580540 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:41:29.581295 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:41:29.580959 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:41:29.581924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:29.581576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:29.637786 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m14:41:29.638157 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.057 seconds
[0m14:41:29.639659 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:41:29.640756 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:41:29.641881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_staging)
[0m14:41:29.642163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now create_primary_app_db_public_analytics)
[0m14:41:29.643229 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_analytics"
"
[0m14:41:29.642822 [debug] [ThreadPool]: Creating schema "database: "primary_app_db"
schema: "public_staging"
"
[0m14:41:29.647296 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m14:41:29.648892 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: BEGIN
[0m14:41:29.648616 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m14:41:29.649382 [debug] [ThreadPool]: On create_primary_app_db_public_staging: BEGIN
[0m14:41:29.649138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:29.649620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:29.655551 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:41:29.655935 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m14:41:29.656130 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:41:29.656683 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m14:41:29.656405 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_analytics"} */
create schema if not exists "public_analytics"
[0m14:41:29.656944 [debug] [ThreadPool]: On create_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "create_primary_app_db_public_staging"} */
create schema if not exists "public_staging"
[0m14:41:29.657603 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:41:29.657796 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:41:29.659312 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m14:41:29.658565 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m14:41:29.659837 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_analytics"
[0m14:41:29.659573 [debug] [ThreadPool]: Using postgres connection "create_primary_app_db_public_staging"
[0m14:41:29.660337 [debug] [ThreadPool]: On create_primary_app_db_public_staging: COMMIT
[0m14:41:29.660078 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: COMMIT
[0m14:41:29.660980 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.661426 [debug] [ThreadPool]: On create_primary_app_db_public_staging: Close
[0m14:41:29.661190 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:41:29.661762 [debug] [ThreadPool]: On create_primary_app_db_public_analytics: Close
[0m14:41:29.664034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_staging, now list_primary_app_db_public_staging)
[0m14:41:29.664425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_primary_app_db_public_analytics, now list_primary_app_db_public_analytics)
[0m14:41:29.668863 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:41:29.670253 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:41:29.670530 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:41:29.670777 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:41:29.671005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:29.671214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:29.676430 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:41:29.676753 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:41:29.676964 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:41:29.677233 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:41:29.677581 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:41:29.678040 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:41:29.680039 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:41:29.681142 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:41:29.681370 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:41:29.681753 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:41:29.682716 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:41:29.683325 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:41:29.687856 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.688246 [debug] [MainThread]: On master: BEGIN
[0m14:41:29.688549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:29.693995 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:41:29.694346 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.694779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:29.697824 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:41:29.699075 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:29.699459 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.699754 [debug] [MainThread]: On master: BEGIN
[0m14:41:29.700160 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:29.700438 [debug] [MainThread]: On master: COMMIT
[0m14:41:29.700716 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.700990 [debug] [MainThread]: On master: COMMIT
[0m14:41:29.701335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.701610 [debug] [MainThread]: On master: Close
[0m14:41:29.703892 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m14:41:29.704241 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m14:41:29.704523 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m14:41:29.705020 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m14:41:29.706309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_order_items)
[0m14:41:29.705929 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m14:41:29.705488 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m14:41:29.706641 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m14:41:29.707160 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m14:41:29.707518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_orders)
[0m14:41:29.713726 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m14:41:29.714342 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m14:41:29.714677 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m14:41:29.717826 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m14:41:29.720711 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m14:41:29.721445 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m14:41:29.734479 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m14:41:29.752421 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m14:41:29.753297 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m14:41:29.756556 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m14:41:29.760491 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m14:41:29.761277 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:41:29.762472 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m14:41:29.763207 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:29.763529 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:41:29.763851 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:41:29.764361 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m14:41:29.765323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:29.765034 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m14:41:29.765706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:29.769686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m14:41:29.770171 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:41:29.770664 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m14:41:29.771734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:41:29.773049 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:41:29.774450 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m14:41:29.773946 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:41:29.773657 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:41:29.782142 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:41:29.781716 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:41:29.781172 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:41:29.782556 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m14:41:29.783031 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:41:29.785850 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:41:29.786766 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:29.787217 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m14:41:29.799071 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:41:29.799383 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:41:29.799877 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:41:29.800172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:29.802396 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:41:29.802758 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:41:29.803844 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:41:29.804163 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:41:29.804643 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:41:29.804910 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.805294 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:41:29.805543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:29.810717 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m14:41:29.811924 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:41:29.816189 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:41:29.815869 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:41:29.812182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:29.816454 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:41:29.816779 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m14:41:29.818358 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m14:41:29.818905 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.819144 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:41:29.819609 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:41:29.823353 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m14:41:29.823025 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m14:41:29.821136 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m14:41:29.825257 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:41:29.823813 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:41:29.825722 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:41:29.826215 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m14:41:29.827340 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m14:41:29.828042 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m14:41:29.828987 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:29.828771 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:41:29.829642 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m14:41:29.830588 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m14:41:29.831188 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m14:41:29.832523 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:41:29.831929 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m14:41:29.833149 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m14:41:29.833543 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m14:41:29.833994 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m14:41:29.836872 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m14:41:29.838356 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m14:41:29.855357 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m14:41:29.856747 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:41:29.857074 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m14:41:29.857357 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:29.862769 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m14:41:29.863073 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:41:29.863378 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m14:41:29.866374 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:41:29.868710 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:41:29.869045 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:41:29.869476 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:29.873383 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:41:29.873822 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:41:29.874081 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:41:29.874755 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.876347 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m14:41:29.878558 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:41:29.878859 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m14:41:29.879234 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:41:29.880399 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m14:41:29.881168 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m14:41:29.881711 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m14:41:29.882973 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m14:41:29.883355 [info ] [Thread-3 (]: 5 of 5 START sql incremental model public_analytics.fact_sales ................. [RUN]
[0m14:41:29.883706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m14:41:29.883978 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m14:41:29.887499 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m14:41:29.889170 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m14:41:29.912809 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m14:41:29.914308 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.914655 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m14:41:29.914991 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:29.920400 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m14:41:29.920924 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.921532 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      
  
    

  create  table "primary_app_db"."public_analytics"."fact_sales"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()

    
  );
  
  
[0m14:41:29.925231 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:41:29.927169 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.927560 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_sales_date ON "primary_app_db"."public_analytics"."fact_sales" (sales_date)
      
[0m14:41:29.929006 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:41:29.930192 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.930476 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_product_key ON "primary_app_db"."public_analytics"."fact_sales" (product_key)
      
[0m14:41:29.931594 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:41:29.932700 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.932982 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_order_key ON "primary_app_db"."public_analytics"."fact_sales" (order_key)
      
[0m14:41:29.934006 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:41:29.934756 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:41:29.935025 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:41:29.935278 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:41:29.936046 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.936685 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m14:41:29.937301 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model public_analytics.fact_sales ............ [[32mSELECT 0[0m in 0.05s]
[0m14:41:29.937871 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m14:41:29.939048 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.939382 [debug] [MainThread]: On master: BEGIN
[0m14:41:29.939678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:29.944692 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:41:29.944979 [debug] [MainThread]: On master: COMMIT
[0m14:41:29.945258 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:29.945530 [debug] [MainThread]: On master: COMMIT
[0m14:41:29.945834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:29.946082 [debug] [MainThread]: On master: Close
[0m14:41:29.946436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:29.946775 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m14:41:29.947006 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m14:41:29.947222 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m14:41:29.947447 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m14:41:29.947944 [info ] [MainThread]: 
[0m14:41:29.948264 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 3 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:41:29.949445 [debug] [MainThread]: Command end result
[0m14:41:29.987246 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:41:29.989509 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:41:29.997973 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:41:29.998450 [info ] [MainThread]: 
[0m14:41:29.999037 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:29.999454 [info ] [MainThread]: 
[0m14:41:29.999879 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:41:30.001281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3475819, "process_in_blocks": "0", "process_kernel_time": 0.148924, "process_mem_max_rss": "137412", "process_out_blocks": "3806", "process_user_time": 3.253342}
[0m14:41:30.001769 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:30.001675 after 2.35 seconds
[0m14:41:30.002119 [debug] [MainThread]: Flushing usage events


============================== 14:43:01.524874 | 1534d80b-39ed-41ae-add9-8169805b0cdb ==============================
[0m14:43:01.524874 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:43:01.535730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --target prod', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:43:01.536352 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:43:01.679169 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0cjelnnr'
[0m14:43:01.679883 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:43:01.810148 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:43:01.811571 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:43:01.846116 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:43:01.849741 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:43:02.188725 [info ] [MainThread]: Installed from version 1.1.1
[0m14:43:02.189576 [info ] [MainThread]: Updated version available: 1.3.1
[0m14:43:02.189969 [info ] [MainThread]: 
[0m14:43:02.190548 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:43:02.193020 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.71870035, "process_in_blocks": "0", "process_kernel_time": 0.131934, "process_mem_max_rss": "107696", "process_out_blocks": "2204", "process_user_time": 1.296359}
[0m14:43:02.193597 [debug] [MainThread]: Command `dbt deps` succeeded at 14:43:02.193458 after 0.72 seconds
[0m14:43:02.193957 [debug] [MainThread]: Flushing usage events


============================== 14:43:03.570022 | 210824ad-7ba9-4aa4-8ed5-74d4d0d8b592 ==============================
[0m14:43:03.570022 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:43:03.577131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m14:43:03.577776 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:43:03.780917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:43:03.852211 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:43:03.981977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:03.982489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:04.112073 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:43:04.114785 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:43:04.137947 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:43:04.140080 [info ] [MainThread]: 
[0m14:43:04.140522 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:43:04.140974 [info ] [MainThread]: 
[0m14:43:04.141703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:04.146421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:43:04.147089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:43:04.183017 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:43:04.183738 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:43:04.183377 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:43:04.184016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:04.184297 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:43:04.186369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:04.243979 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.057 seconds
[0m14:43:04.244371 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m14:43:04.245996 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:43:04.247021 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:43:04.249743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m14:43:04.250135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m14:43:04.254923 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:43:04.256487 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:43:04.256844 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:43:04.257179 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:43:04.257527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:04.257829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:04.264028 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:43:04.264418 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:43:04.264663 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:43:04.265007 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:43:04.265357 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:43:04.265831 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:43:04.268172 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:43:04.268382 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:43:04.269477 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:43:04.270498 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:43:04.270982 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:43:04.271275 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:43:04.276472 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.276859 [debug] [MainThread]: On master: BEGIN
[0m14:43:04.277131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:04.282521 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:43:04.282875 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.283550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:04.287728 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m14:43:04.289132 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:04.289523 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.289806 [debug] [MainThread]: On master: BEGIN
[0m14:43:04.290257 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:43:04.290580 [debug] [MainThread]: On master: COMMIT
[0m14:43:04.290848 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.291136 [debug] [MainThread]: On master: COMMIT
[0m14:43:04.291536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:43:04.291822 [debug] [MainThread]: On master: Close
[0m14:43:04.293931 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m14:43:04.294240 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m14:43:04.294622 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m14:43:04.295084 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m14:43:04.295595 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m14:43:04.296087 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m14:43:04.296551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m14:43:04.296922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m14:43:04.297423 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m14:43:04.297812 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m14:43:04.298142 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m14:43:04.298497 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m14:43:04.304201 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m14:43:04.307090 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m14:43:04.309183 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m14:43:04.310955 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m14:43:04.311225 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m14:43:04.311499 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m14:43:04.342568 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m14:43:04.343112 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m14:43:04.345307 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m14:43:04.347986 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.348287 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.348599 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.348808 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m14:43:04.349111 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m14:43:04.349976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:04.349696 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:43:04.349401 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m14:43:04.351006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:43:04.355597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:43:04.355913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m14:43:04.357358 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.357717 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.358354 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m14:43:04.359600 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m14:43:04.360522 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:43:04.361069 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.361594 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m14:43:04.362003 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:43:04.362309 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:43:04.367357 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.367652 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:43:04.369721 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.370076 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:43:04.372188 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.372975 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:43:04.372513 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m14:43:04.373250 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.373753 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.373969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.376046 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.379744 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.384281 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.384824 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:43:04.385215 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:43:04.385569 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m14:43:04.386363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.386947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:43:04.386696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:43:04.401827 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:43:04.403312 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:43:04.404553 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:43:04.404971 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.405380 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.406591 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:43:04.406165 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:43:04.405773 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.407405 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:43:04.407961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:43:04.408355 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:43:04.408668 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:43:04.414838 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m14:43:04.416726 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m14:43:04.418410 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m14:43:04.422362 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:43:04.423756 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m14:43:04.423410 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:43:04.422888 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:43:04.424257 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m14:43:04.424636 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m14:43:04.425505 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:43:04.425825 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:43:04.429035 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m14:43:04.428020 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m14:43:04.426106 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:43:04.430576 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:43:04.431145 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.13s]
[0m14:43:04.432314 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m14:43:04.432886 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m14:43:04.433388 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m14:43:04.433946 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:43:04.434682 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m14:43:04.435153 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m14:43:04.435543 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m14:43:04.436078 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m14:43:04.436369 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m14:43:04.438914 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m14:43:04.439916 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m14:43:04.456666 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m14:43:04.457769 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.458089 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m14:43:04.458369 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:43:04.463924 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m14:43:04.464202 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.464571 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m14:43:04.467344 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:43:04.470125 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.470446 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m14:43:04.470908 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.473799 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.474095 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:43:04.474518 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:04.478449 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:43:04.478798 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.479089 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:43:04.479673 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m14:43:04.481431 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m14:43:04.483594 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:43:04.483924 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m14:43:04.485690 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:43:04.486766 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m14:43:04.487384 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m14:43:04.487914 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m14:43:04.489197 [debug] [Thread-1 (]: Began running node model.data_models.fact_sales
[0m14:43:04.489556 [info ] [Thread-1 (]: 5 of 5 START sql incremental model public_analytics.fact_sales ................. [RUN]
[0m14:43:04.489912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_models.stg_order_items, now model.data_models.fact_sales)
[0m14:43:04.490216 [debug] [Thread-1 (]: Began compiling node model.data_models.fact_sales
[0m14:43:04.497705 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m14:43:04.498416 [debug] [Thread-1 (]: Began executing node model.data_models.fact_sales
[0m14:43:04.520770 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.521273 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

    
  
    

  create temporary table "fact_sales__dbt_tmp144304516557"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()

    
    -- Only process records newer than the latest already built
    AND o.order_timestamp > (
        SELECT COALESCE(MAX(sales_timestamp), TIMESTAMP '1900-01-01') FROM "primary_app_db"."public_analytics"."fact_sales"
    )
    
  );
  
  
[0m14:43:04.521719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:04.530134 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:43:04.539689 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.540036 [debug] [Thread-1 (]: On model.data_models.fact_sales: BEGIN
[0m14:43:04.540482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m14:43:04.540820 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.541134 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144304516557'
        
      order by ordinal_position

  
[0m14:43:04.546360 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.005 seconds
[0m14:43:04.550471 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.550816 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:43:04.552527 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:43:04.562667 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.563027 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144304516557'
        
      order by ordinal_position

  
[0m14:43:04.564676 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:43:04.566908 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.567251 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:43:04.568811 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:43:04.575850 [debug] [Thread-1 (]: 
    In "primary_app_db"."public_analytics"."fact_sales":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:43:04.587717 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m14:43:04.589772 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.590891 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      
        
            delete from "primary_app_db"."public_analytics"."fact_sales"
            using "fact_sales__dbt_tmp144304516557"
            where (
                
                    "fact_sales__dbt_tmp144304516557".order_key = "primary_app_db"."public_analytics"."fact_sales".order_key
                    and 
                
                    "fact_sales__dbt_tmp144304516557".product_key = "primary_app_db"."public_analytics"."fact_sales".product_key
                    
                
                
            );
        
    

    insert into "primary_app_db"."public_analytics"."fact_sales" ("order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system")
    (
        select "order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system"
        from "fact_sales__dbt_tmp144304516557"
    )
  
[0m14:43:04.591934 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:43:04.594033 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.594431 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_sales_date ON "primary_app_db"."public_analytics"."fact_sales" (sales_date)
      
[0m14:43:04.595053 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:43:04.596588 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.596926 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_product_key ON "primary_app_db"."public_analytics"."fact_sales" (product_key)
      
[0m14:43:04.597400 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:43:04.598568 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.598881 [debug] [Thread-1 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_order_key ON "primary_app_db"."public_analytics"."fact_sales" (order_key)
      
[0m14:43:04.599305 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:43:04.600036 [debug] [Thread-1 (]: On model.data_models.fact_sales: COMMIT
[0m14:43:04.600339 [debug] [Thread-1 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:43:04.600637 [debug] [Thread-1 (]: On model.data_models.fact_sales: COMMIT
[0m14:43:04.601407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:43:04.601998 [debug] [Thread-1 (]: On model.data_models.fact_sales: Close
[0m14:43:04.602669 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model public_analytics.fact_sales ............ [[32mINSERT 0 0[0m in 0.11s]
[0m14:43:04.603224 [debug] [Thread-1 (]: Finished running node model.data_models.fact_sales
[0m14:43:04.604483 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.604855 [debug] [MainThread]: On master: BEGIN
[0m14:43:04.605142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:04.611678 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:43:04.612201 [debug] [MainThread]: On master: COMMIT
[0m14:43:04.612572 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:04.612933 [debug] [MainThread]: On master: COMMIT
[0m14:43:04.613377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:43:04.613699 [debug] [MainThread]: On master: Close
[0m14:43:04.614225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:04.614597 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m14:43:04.614934 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m14:43:04.615241 [debug] [MainThread]: Connection 'model.data_models.stg_products' was properly closed.
[0m14:43:04.615597 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m14:43:04.616315 [info ] [MainThread]: 
[0m14:43:04.616769 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 3 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m14:43:04.618207 [debug] [MainThread]: Command end result
[0m14:43:04.647175 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:43:04.648795 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:43:04.654611 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:43:04.654906 [info ] [MainThread]: 
[0m14:43:04.655284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:04.655578 [info ] [MainThread]: 
[0m14:43:04.655964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:43:04.657154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1555599, "process_in_blocks": "0", "process_kernel_time": 0.149481, "process_mem_max_rss": "132608", "process_out_blocks": "2663", "process_user_time": 2.059752}
[0m14:43:04.657686 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:04.657562 after 1.16 seconds
[0m14:43:04.658162 [debug] [MainThread]: Flushing usage events


============================== 14:45:32.078880 | 8a5b6efc-be46-4211-92a4-783a42a6d568 ==============================
[0m14:45:32.078880 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:45:32.090094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --target prod', 'send_anonymous_usage_stats': 'False'}
[0m14:45:32.090775 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:45:32.269984 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qo_ec89u'
[0m14:45:32.270458 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:45:32.375962 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:45:32.377277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:45:32.407183 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:45:32.410684 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:45:32.726754 [info ] [MainThread]: Installed from version 1.1.1
[0m14:45:32.727238 [info ] [MainThread]: Updated version available: 1.3.1
[0m14:45:32.727614 [info ] [MainThread]: 
[0m14:45:32.728067 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:45:32.730566 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7025053, "process_in_blocks": "0", "process_kernel_time": 0.111412, "process_mem_max_rss": "107804", "process_out_blocks": "2204", "process_user_time": 1.206634}
[0m14:45:32.731186 [debug] [MainThread]: Command `dbt deps` succeeded at 14:45:32.731080 after 0.70 seconds
[0m14:45:32.731474 [debug] [MainThread]: Flushing usage events


============================== 14:45:34.084097 | 7b737d34-e412-43ef-9793-bf9d3e82e8f4 ==============================
[0m14:45:34.084097 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:45:34.091311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target prod', 'send_anonymous_usage_stats': 'False'}
[0m14:45:34.091936 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:45:34.296927 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:45:34.373008 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:45:34.492985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:34.493401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:34.623681 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:45:34.626781 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:45:34.649889 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:45:34.652079 [info ] [MainThread]: 
[0m14:45:34.652477 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:45:34.652867 [info ] [MainThread]: 
[0m14:45:34.653509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:34.658232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:45:34.659013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:45:34.690299 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:45:34.690600 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:45:34.691151 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:45:34.690901 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:45:34.691607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:34.691387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:34.739366 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m14:45:34.739723 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.048 seconds
[0m14:45:34.741302 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:45:34.742388 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:45:34.745088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m14:45:34.745482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m14:45:34.749984 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:45:34.751351 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:45:34.751697 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:45:34.751999 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:45:34.752294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:34.752585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:34.758487 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:45:34.758826 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:45:34.759150 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:45:34.759580 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:45:34.759903 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:45:34.760214 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:45:34.761813 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:45:34.762976 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:45:34.763207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:45:34.763613 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:45:34.764603 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:45:34.765945 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:45:34.770361 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:34.770717 [debug] [MainThread]: On master: BEGIN
[0m14:45:34.771009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:34.776365 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:45:34.776680 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:34.777086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:34.780509 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m14:45:34.781784 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:34.782153 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:34.782424 [debug] [MainThread]: On master: BEGIN
[0m14:45:34.782858 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:45:34.783189 [debug] [MainThread]: On master: COMMIT
[0m14:45:34.783465 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:34.783755 [debug] [MainThread]: On master: COMMIT
[0m14:45:34.784104 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:34.784390 [debug] [MainThread]: On master: Close
[0m14:45:34.786435 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m14:45:34.786744 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m14:45:34.787129 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m14:45:34.787613 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m14:45:34.788115 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m14:45:34.788593 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m14:45:34.788999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_order_items)
[0m14:45:34.789359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_orders)
[0m14:45:34.789797 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m14:45:34.790110 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m14:45:34.790429 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m14:45:34.790763 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m14:45:34.796373 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m14:45:34.798635 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m14:45:34.801489 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m14:45:34.803767 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m14:45:34.804120 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m14:45:34.810093 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m14:45:34.836922 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m14:45:34.839848 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m14:45:34.842751 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m14:45:34.845127 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.845475 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.845851 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.846187 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m14:45:34.847272 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:34.846902 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m14:45:34.846516 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m14:45:34.848295 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:34.847890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:34.854736 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:34.855222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:34.855484 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.855935 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.856560 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m14:45:34.857017 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m14:45:34.857324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:45:34.857946 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.858335 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m14:45:34.859247 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:45:34.859530 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:45:34.859818 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:45:34.864646 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.866844 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.868883 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.869905 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:45:34.869589 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:45:34.869213 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m14:45:34.870466 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:34.870712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:34.870963 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:34.873022 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.877866 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:45:34.877562 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.875004 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.878301 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:45:34.878577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:34.878853 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m14:45:34.885150 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:45:34.891894 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:45:34.893128 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:45:34.893407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:34.893704 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.894049 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.895091 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:45:34.896247 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.895926 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:45:34.895470 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:45:34.896587 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:45:34.899063 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:34.899573 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:45:34.899338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:34.904793 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m14:45:34.906430 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m14:45:34.912241 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:45:34.911747 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:45:34.908024 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m14:45:34.912575 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m14:45:34.912932 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m14:45:34.913398 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:45:34.913989 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m14:45:34.914769 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:34.915059 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:34.915363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:34.917219 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m14:45:34.918314 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m14:45:34.919268 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m14:45:34.920868 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:45:34.921478 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:45:34.922088 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.13s]
[0m14:45:34.922732 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m14:45:34.923198 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m14:45:34.923654 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m14:45:34.924324 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m14:45:34.924831 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m14:45:34.925286 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m14:45:34.925621 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m14:45:34.928231 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m14:45:34.929411 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m14:45:34.946618 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m14:45:34.947691 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.948022 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m14:45:34.948313 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:34.953565 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m14:45:34.953865 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.954176 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m14:45:34.956691 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m14:45:34.959124 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.959478 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m14:45:34.959999 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:34.962039 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.962332 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:45:34.962756 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:34.966528 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:45:34.966843 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.967121 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:45:34.967663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m14:45:34.969968 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m14:45:34.971969 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:45:34.972279 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m14:45:34.973705 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:45:34.974729 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m14:45:34.975357 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m14:45:34.975923 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m14:45:34.977246 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m14:45:34.977649 [info ] [Thread-3 (]: 5 of 5 START sql incremental model public_analytics.fact_sales ................. [RUN]
[0m14:45:34.978032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m14:45:34.978314 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m14:45:34.986010 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m14:45:34.986743 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m14:45:35.008613 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.009083 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

    
  
    

  create temporary table "fact_sales__dbt_tmp144535004668"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()

    
    -- Only process records newer than the latest already built
    AND o.order_timestamp > (
        SELECT COALESCE(MAX(sales_timestamp), TIMESTAMP '1900-01-01') FROM "primary_app_db"."public_analytics"."fact_sales"
    )
    
  );
  
  
[0m14:45:35.009484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:35.017896 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:45:35.032746 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.033464 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m14:45:35.034155 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m14:45:35.034475 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.034838 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144535004668'
        
      order by ordinal_position

  
[0m14:45:35.040326 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.005 seconds
[0m14:45:35.044920 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.045311 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:45:35.047022 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:45:35.060135 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.060737 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144535004668'
        
      order by ordinal_position

  
[0m14:45:35.063125 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.002 seconds
[0m14:45:35.065516 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.065866 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:45:35.067618 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:45:35.075235 [debug] [Thread-3 (]: 
    In "primary_app_db"."public_analytics"."fact_sales":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:45:35.086813 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m14:45:35.087666 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.088025 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      
        
            delete from "primary_app_db"."public_analytics"."fact_sales"
            using "fact_sales__dbt_tmp144535004668"
            where (
                
                    "fact_sales__dbt_tmp144535004668".order_key = "primary_app_db"."public_analytics"."fact_sales".order_key
                    and 
                
                    "fact_sales__dbt_tmp144535004668".product_key = "primary_app_db"."public_analytics"."fact_sales".product_key
                    
                
                
            );
        
    

    insert into "primary_app_db"."public_analytics"."fact_sales" ("order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system")
    (
        select "order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system"
        from "fact_sales__dbt_tmp144535004668"
    )
  
[0m14:45:35.088823 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m14:45:35.090268 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.090574 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_sales_date ON "primary_app_db"."public_analytics"."fact_sales" (sales_date)
      
[0m14:45:35.091058 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:45:35.092405 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.092731 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_product_key ON "primary_app_db"."public_analytics"."fact_sales" (product_key)
      
[0m14:45:35.093159 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:45:35.094305 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.094611 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_order_key ON "primary_app_db"."public_analytics"."fact_sales" (order_key)
      
[0m14:45:35.094980 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:45:35.095696 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:45:35.095969 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:45:35.096225 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:45:35.096746 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:45:35.097307 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m14:45:35.097976 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model public_analytics.fact_sales ............ [[32mINSERT 0 0[0m in 0.12s]
[0m14:45:35.098500 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m14:45:35.099775 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:35.100084 [debug] [MainThread]: On master: BEGIN
[0m14:45:35.100368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:35.105397 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:45:35.105691 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.105942 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:35.106183 [debug] [MainThread]: On master: COMMIT
[0m14:45:35.106471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:35.106758 [debug] [MainThread]: On master: Close
[0m14:45:35.107105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:35.107378 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m14:45:35.107889 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m14:45:35.108255 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m14:45:35.108513 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m14:45:35.109078 [info ] [MainThread]: 
[0m14:45:35.109427 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 3 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m14:45:35.110762 [debug] [MainThread]: Command end result
[0m14:45:35.139094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:45:35.140657 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:45:35.146179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:45:35.146444 [info ] [MainThread]: 
[0m14:45:35.146869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:35.147152 [info ] [MainThread]: 
[0m14:45:35.147491 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:45:35.148740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1325288, "process_in_blocks": "0", "process_kernel_time": 0.12119, "process_mem_max_rss": "130748", "process_out_blocks": "2663", "process_user_time": 2.095452}
[0m14:45:35.149261 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:35.149151 after 1.13 seconds
[0m14:45:35.149607 [debug] [MainThread]: Flushing usage events


============================== 14:45:36.301411 | f49938b7-80ea-4416-b4f3-e8fdc59b60e4 ==============================
[0m14:45:36.301411 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:45:36.308547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --target prod', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:45:36.309175 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:45:36.508350 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:45:36.569550 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:45:36.683117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:36.683577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:36.812033 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:45:36.814481 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:45:36.843101 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:45:36.846027 [info ] [MainThread]: 
[0m14:45:36.846435 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:45:36.846822 [info ] [MainThread]: 
[0m14:45:36.847394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:36.852288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db_public_staging'
[0m14:45:36.852963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db_public_analytics'
[0m14:45:36.880034 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:45:36.880324 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:45:36.880612 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:45:36.880981 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:45:36.881291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:36.881586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:36.958400 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m14:45:36.958790 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m14:45:36.959211 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:45:36.959575 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:45:36.959956 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:45:36.960324 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:45:36.962748 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m14:45:36.962979 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:45:36.964560 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:45:36.965674 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:45:36.966111 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:45:36.966366 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:45:36.973419 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:36.973815 [debug] [MainThread]: On master: BEGIN
[0m14:45:36.974124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:36.980000 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:45:36.980445 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:36.980899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:36.983958 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m14:45:36.985336 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:36.985737 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:36.986047 [debug] [MainThread]: On master: BEGIN
[0m14:45:36.986468 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:45:36.986766 [debug] [MainThread]: On master: COMMIT
[0m14:45:36.987037 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:36.987300 [debug] [MainThread]: On master: COMMIT
[0m14:45:36.987640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:36.987909 [debug] [MainThread]: On master: Close
[0m14:45:36.990184 [debug] [Thread-1 (]: Began running node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:45:36.990504 [debug] [Thread-2 (]: Began running node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:45:36.990806 [debug] [Thread-3 (]: Began running node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:45:36.991108 [debug] [Thread-4 (]: Began running node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:45:36.991405 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_  [RUN]
[0m14:45:36.991847 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0  [RUN]
[0m14:45:36.992263 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_expression_is_true_fact_sales_units_sold_0 ........ [RUN]
[0m14:45:36.992631 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_expression_is_true_stg_order_items_quantity_0 ..... [RUN]
[0m14:45:36.993086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9)
[0m14:45:36.993455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720)
[0m14:45:36.994043 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7'
[0m14:45:36.994493 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01'
[0m14:45:36.994845 [debug] [Thread-1 (]: Began compiling node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:45:36.995194 [debug] [Thread-2 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:45:36.995545 [debug] [Thread-3 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:45:36.995929 [debug] [Thread-4 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:45:37.008939 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:45:37.015910 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:45:37.019203 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:45:37.022194 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:45:37.023515 [debug] [Thread-1 (]: Began executing node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:45:37.032501 [debug] [Thread-2 (]: Began executing node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:45:37.035662 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:45:37.036065 [debug] [Thread-3 (]: Began executing node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:45:37.039619 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:45:37.039959 [debug] [Thread-4 (]: Began executing node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:45:37.041568 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:45:37.043374 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:45:37.043872 [debug] [Thread-1 (]: Using postgres connection "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:45:37.044291 [debug] [Thread-2 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:45:37.044841 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: BEGIN
[0m14:45:37.045128 [debug] [Thread-3 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:45:37.045553 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: BEGIN
[0m14:45:37.045899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.046263 [debug] [Thread-4 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:45:37.046573 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: BEGIN
[0m14:45:37.046865 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:37.047348 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: BEGIN
[0m14:45:37.047677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:37.048208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:37.052723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:37.053338 [debug] [Thread-1 (]: Using postgres connection "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:45:37.053681 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:37.054087 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "primary_app_db"."public_analytics"."fact_sales"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sales_timestamp >= '2000-01-01'
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sales_timestamp <= NOW()
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m14:45:37.054388 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m14:45:37.054707 [debug] [Thread-2 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:45:37.055220 [debug] [Thread-4 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:45:37.055642 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_analytics"."fact_sales"

where not(gross_revenue_amount >= 0)


      
    ) dbt_internal_test
[0m14:45:37.055972 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.056259 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m14:45:37.056537 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_staging"."stg_order_items"

where not(quantity > 0)


      
    ) dbt_internal_test
[0m14:45:37.061286 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: ROLLBACK
[0m14:45:37.061626 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:45:37.061929 [debug] [Thread-3 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:45:37.062496 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: Close
[0m14:45:37.063662 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: ROLLBACK
[0m14:45:37.063933 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:45:37.064258 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_analytics"."fact_sales"

where not(units_sold > 0)


      
    ) dbt_internal_test
[0m14:45:37.064906 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_  [[32mPASS[0m in 0.07s]
[0m14:45:37.065372 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: Close
[0m14:45:37.066466 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: ROLLBACK
[0m14:45:37.067302 [debug] [Thread-1 (]: Finished running node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:45:37.067602 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.068056 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0 .... [[32mPASS[0m in 0.07s]
[0m14:45:37.068507 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: Close
[0m14:45:37.068817 [debug] [Thread-1 (]: Began running node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:45:37.070049 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: ROLLBACK
[0m14:45:37.070502 [debug] [Thread-2 (]: Finished running node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:45:37.070987 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_expression_is_true_stg_order_items_quantity_0 ........... [[32mPASS[0m in 0.08s]
[0m14:45:37.071375 [info ] [Thread-1 (]: 5 of 21 START test not_null_dim_products_product_pk ............................ [RUN]
[0m14:45:37.071889 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: Close
[0m14:45:37.072162 [debug] [Thread-2 (]: Began running node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:45:37.072647 [debug] [Thread-4 (]: Finished running node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:45:37.072999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9, now test.data_models.not_null_dim_products_product_pk.ff139bf0d7)
[0m14:45:37.073476 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_expression_is_true_fact_sales_units_sold_0 .............. [[32mPASS[0m in 0.08s]
[0m14:45:37.075056 [debug] [Thread-3 (]: Finished running node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:45:37.074275 [debug] [Thread-4 (]: Began running node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:45:37.074625 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:45:37.073849 [info ] [Thread-2 (]: 6 of 21 START test not_null_dim_products_product_sku ........................... [RUN]
[0m14:45:37.081194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720, now test.data_models.not_null_dim_products_product_sku.1098c1a343)
[0m14:45:37.075745 [info ] [Thread-4 (]: 7 of 21 START test not_null_fact_sales_gross_revenue_amount .................... [RUN]
[0m14:45:37.080845 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:45:37.075377 [debug] [Thread-3 (]: Began running node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:45:37.081496 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:45:37.081843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01, now test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d)
[0m14:45:37.082356 [info ] [Thread-3 (]: 8 of 21 START test not_null_fact_sales_order_key ............................... [RUN]
[0m14:45:37.085760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7, now test.data_models.not_null_fact_sales_order_key.ac23b4dcda)
[0m14:45:37.085387 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:45:37.084982 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:45:37.086016 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:45:37.086285 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:45:37.089022 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:45:37.090749 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:45:37.093385 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:45:37.093742 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:45:37.095738 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:45:37.096061 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:45:37.096449 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:45:37.096716 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:45:37.100139 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: BEGIN
[0m14:45:37.099601 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:45:37.099881 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:45:37.098112 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:45:37.100393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.100788 [debug] [Thread-2 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: BEGIN
[0m14:45:37.101885 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:45:37.104054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:37.107193 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:45:37.107712 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: BEGIN
[0m14:45:37.108894 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: BEGIN
[0m14:45:37.109508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:37.110302 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:37.112456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:45:37.113386 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:45:37.113860 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_pk
from "primary_app_db"."public_analytics"."dim_products"
where product_pk is null



      
    ) dbt_internal_test
[0m14:45:37.114472 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m14:45:37.114753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m14:45:37.115114 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:45:37.116542 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: ROLLBACK
[0m14:45:37.116962 [debug] [Thread-2 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_dim_products_product_sku.1098c1a343"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sku
from "primary_app_db"."public_analytics"."dim_products"
where product_sku is null



      
    ) dbt_internal_test
[0m14:45:37.117618 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: Close
[0m14:45:37.118043 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m14:45:37.118361 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m14:45:37.118678 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m14:45:37.119167 [info ] [Thread-1 (]: 5 of 21 PASS not_null_dim_products_product_pk .................................. [[32mPASS[0m in 0.05s]
[0m14:45:37.119560 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:45:37.120784 [debug] [Thread-2 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: ROLLBACK
[0m14:45:37.121110 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:45:37.121627 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:45:37.121986 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gross_revenue_amount
from "primary_app_db"."public_analytics"."fact_sales"
where gross_revenue_amount is null



      
    ) dbt_internal_test
[0m14:45:37.122413 [debug] [Thread-2 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: Close
[0m14:45:37.122706 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "primary_app_db"."public_analytics"."fact_sales"
where order_key is null



      
    ) dbt_internal_test
[0m14:45:37.123120 [debug] [Thread-1 (]: Began running node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:45:37.123773 [info ] [Thread-2 (]: 6 of 21 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 0.04s]
[0m14:45:37.125356 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:45:37.124542 [info ] [Thread-1 (]: 9 of 21 START test not_null_fact_sales_product_key ............................. [RUN]
[0m14:45:37.124934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.124070 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.125752 [debug] [Thread-2 (]: Began running node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:45:37.126166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_dim_products_product_pk.ff139bf0d7, now test.data_models.not_null_fact_sales_product_key.e4fd332b98)
[0m14:45:37.128055 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: ROLLBACK
[0m14:45:37.129412 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: ROLLBACK
[0m14:45:37.129921 [info ] [Thread-2 (]: 10 of 21 START test not_null_fact_sales_sales_date ............................. [RUN]
[0m14:45:37.130399 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:45:37.131171 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: Close
[0m14:45:37.131445 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: Close
[0m14:45:37.131911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_dim_products_product_sku.1098c1a343, now test.data_models.not_null_fact_sales_sales_date.b9941c8fee)
[0m14:45:37.135650 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:45:37.136361 [info ] [Thread-4 (]: 7 of 21 PASS not_null_fact_sales_gross_revenue_amount .......................... [[32mPASS[0m in 0.05s]
[0m14:45:37.136808 [info ] [Thread-3 (]: 8 of 21 PASS not_null_fact_sales_order_key ..................................... [[32mPASS[0m in 0.05s]
[0m14:45:37.137473 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:45:37.138375 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:45:37.139016 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:45:37.139478 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:45:37.143850 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:45:37.144294 [debug] [Thread-4 (]: Began running node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:45:37.144714 [debug] [Thread-3 (]: Began running node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:45:37.146569 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:45:37.147399 [info ] [Thread-4 (]: 11 of 21 START test not_null_fact_sales_sales_timestamp ........................ [RUN]
[0m14:45:37.147893 [info ] [Thread-3 (]: 12 of 21 START test not_null_fact_sales_units_sold ............................. [RUN]
[0m14:45:37.148555 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:45:37.148864 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d, now test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33)
[0m14:45:37.149387 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_order_key.ac23b4dcda, now test.data_models.not_null_fact_sales_units_sold.e428e81951)
[0m14:45:37.149920 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:45:37.151762 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:45:37.152111 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:45:37.152422 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:45:37.152743 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: BEGIN
[0m14:45:37.155918 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:45:37.156352 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:45:37.159016 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:45:37.159348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.159894 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: BEGIN
[0m14:45:37.160283 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:45:37.161063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:37.161484 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:45:37.162985 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:45:37.165052 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:45:37.166116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:37.166408 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:45:37.169002 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: BEGIN
[0m14:45:37.168085 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:45:37.167851 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:45:37.169292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:37.169635 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: BEGIN
[0m14:45:37.169903 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:45:37.170208 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "primary_app_db"."public_analytics"."fact_sales"
where product_key is null



      
    ) dbt_internal_test
[0m14:45:37.170668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:37.171006 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:45:37.172043 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_date
from "primary_app_db"."public_analytics"."fact_sales"
where sales_date is null



      
    ) dbt_internal_test
[0m14:45:37.172421 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.173933 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: ROLLBACK
[0m14:45:37.174212 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.174768 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: Close
[0m14:45:37.175875 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: ROLLBACK
[0m14:45:37.176465 [info ] [Thread-1 (]: 9 of 21 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.05s]
[0m14:45:37.176828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m14:45:37.177259 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: Close
[0m14:45:37.177579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:37.177962 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:45:37.178292 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:45:37.178789 [info ] [Thread-2 (]: 10 of 21 PASS not_null_fact_sales_sales_date ................................... [[32mPASS[0m in 0.05s]
[0m14:45:37.179166 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:45:37.179537 [debug] [Thread-1 (]: Began running node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:45:37.179897 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_timestamp
from "primary_app_db"."public_analytics"."fact_sales"
where sales_timestamp is null



      
    ) dbt_internal_test
[0m14:45:37.180363 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:45:37.180685 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_units_sold.e428e81951"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select units_sold
from "primary_app_db"."public_analytics"."fact_sales"
where units_sold is null



      
    ) dbt_internal_test
[0m14:45:37.181147 [info ] [Thread-1 (]: 13 of 21 START test not_null_stg_order_items_order_item_pk ..................... [RUN]
[0m14:45:37.181898 [debug] [Thread-2 (]: Began running node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:45:37.182373 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.182840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_product_key.e4fd332b98, now test.data_models.not_null_stg_order_items_order_item_pk.21b2354033)
[0m14:45:37.183209 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.183476 [info ] [Thread-2 (]: 14 of 21 START test not_null_stg_orders_order_pk ............................... [RUN]
[0m14:45:37.184828 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: ROLLBACK
[0m14:45:37.185192 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:45:37.186296 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: ROLLBACK
[0m14:45:37.186663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_sales_date.b9941c8fee, now test.data_models.not_null_stg_orders_order_pk.5306dc2b5e)
[0m14:45:37.187065 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: Close
[0m14:45:37.190079 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:45:37.190492 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: Close
[0m14:45:37.190814 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:45:37.191281 [info ] [Thread-4 (]: 11 of 21 PASS not_null_fact_sales_sales_timestamp .............................. [[32mPASS[0m in 0.04s]
[0m14:45:37.191991 [info ] [Thread-3 (]: 12 of 21 PASS not_null_fact_sales_units_sold ................................... [[32mPASS[0m in 0.04s]
[0m14:45:37.195127 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:45:37.195694 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:45:37.196184 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:45:37.196424 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:45:37.196904 [debug] [Thread-4 (]: Began running node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:45:37.197326 [debug] [Thread-3 (]: Began running node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:45:37.198866 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:45:37.199132 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:45:37.199409 [info ] [Thread-4 (]: 15 of 21 START test not_null_stg_products_product_pk ........................... [RUN]
[0m14:45:37.199775 [info ] [Thread-3 (]: 16 of 21 START test not_null_stg_products_product_sku .......................... [RUN]
[0m14:45:37.202366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_units_sold.e428e81951, now test.data_models.not_null_stg_products_product_sku.ae077a8c6f)
[0m14:45:37.201804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33, now test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d)
[0m14:45:37.202100 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:45:37.201402 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:45:37.202646 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:45:37.202914 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:45:37.203191 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: BEGIN
[0m14:45:37.207100 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:45:37.209775 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:45:37.210153 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:45:37.210402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.210946 [debug] [Thread-2 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: BEGIN
[0m14:45:37.211512 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:45:37.211817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:37.212066 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:45:37.213572 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:45:37.215282 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:45:37.216569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:45:37.217055 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:45:37.217306 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:45:37.217750 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:45:37.217988 [debug] [Thread-4 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: BEGIN
[0m14:45:37.218320 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_pk
from "primary_app_db"."public_staging"."stg_order_items"
where order_item_pk is null



      
    ) dbt_internal_test
[0m14:45:37.218683 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: BEGIN
[0m14:45:37.219007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:37.219404 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:37.220016 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:45:37.220341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.220869 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:45:37.223483 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: ROLLBACK
[0m14:45:37.224485 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m14:45:37.224804 [debug] [Thread-2 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_pk
from "primary_app_db"."public_staging"."stg_orders"
where order_pk is null



      
    ) dbt_internal_test
[0m14:45:37.225175 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: Close
[0m14:45:37.225483 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:45:37.225742 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m14:45:37.226350 [info ] [Thread-1 (]: 13 of 21 PASS not_null_stg_order_items_order_item_pk ........................... [[32mPASS[0m in 0.04s]
[0m14:45:37.226908 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.227280 [debug] [Thread-4 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_pk
from "primary_app_db"."public_staging"."stg_products"
where product_pk is null



      
    ) dbt_internal_test
[0m14:45:37.227714 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:45:37.230000 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sku
from "primary_app_db"."public_staging"."stg_products"
where product_sku is null



      
    ) dbt_internal_test
[0m14:45:37.229476 [debug] [Thread-2 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: ROLLBACK
[0m14:45:37.228273 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:45:37.230538 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.230829 [debug] [Thread-2 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: Close
[0m14:45:37.231112 [debug] [Thread-1 (]: Began running node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:45:37.231373 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.232566 [debug] [Thread-4 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: ROLLBACK
[0m14:45:37.233078 [info ] [Thread-2 (]: 14 of 21 PASS not_null_stg_orders_order_pk ..................................... [[32mPASS[0m in 0.05s]
[0m14:45:37.233437 [info ] [Thread-1 (]: 17 of 21 START test relationships_fact_sales_units_sold__product_pk__ref_dim_products_  [RUN]
[0m14:45:37.234657 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: ROLLBACK
[0m14:45:37.235080 [debug] [Thread-4 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: Close
[0m14:45:37.235459 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:45:37.235834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_order_items_order_item_pk.21b2354033, now test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb)
[0m14:45:37.237703 [debug] [Thread-1 (]: Began compiling node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:45:37.236851 [info ] [Thread-4 (]: 15 of 21 PASS not_null_stg_products_product_pk ................................. [[32mPASS[0m in 0.04s]
[0m14:45:37.237313 [debug] [Thread-2 (]: Began running node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:45:37.236345 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: Close
[0m14:45:37.244139 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:45:37.244629 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:45:37.244990 [info ] [Thread-2 (]: 18 of 21 START test unique_stg_order_items_order_item_pk ....................... [RUN]
[0m14:45:37.245568 [info ] [Thread-3 (]: 16 of 21 PASS not_null_stg_products_product_sku ................................ [[32mPASS[0m in 0.04s]
[0m14:45:37.246158 [debug] [Thread-4 (]: Began running node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:45:37.246580 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_orders_order_pk.5306dc2b5e, now test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7)
[0m14:45:37.246992 [debug] [Thread-1 (]: Began executing node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:45:37.247322 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:45:37.247662 [info ] [Thread-4 (]: 19 of 21 START test unique_stg_orders_order_pk ................................. [RUN]
[0m14:45:37.248058 [debug] [Thread-2 (]: Began compiling node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:45:37.249670 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:45:37.250030 [debug] [Thread-3 (]: Began running node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:45:37.250379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d, now test.data_models.unique_stg_orders_order_pk.11e6f1ee83)
[0m14:45:37.255280 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:45:37.255833 [info ] [Thread-3 (]: 20 of 21 START test unique_stg_products_product_pk ............................. [RUN]
[0m14:45:37.256265 [debug] [Thread-4 (]: Began compiling node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:45:37.256665 [debug] [Thread-1 (]: Using postgres connection "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:45:37.257162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_products_product_sku.ae077a8c6f, now test.data_models.unique_stg_products_product_pk.954d888382)
[0m14:45:37.259774 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:45:37.260106 [debug] [Thread-2 (]: Began executing node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:45:37.260358 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: BEGIN
[0m14:45:37.260673 [debug] [Thread-3 (]: Began compiling node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:45:37.262309 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:45:37.262688 [debug] [Thread-4 (]: Began executing node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:45:37.262942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.265513 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:45:37.268212 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:45:37.268630 [debug] [Thread-2 (]: Using postgres connection "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:45:37.269374 [debug] [Thread-2 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: BEGIN
[0m14:45:37.269790 [debug] [Thread-3 (]: Began executing node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:45:37.270040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:37.270387 [debug] [Thread-4 (]: Using postgres connection "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:45:37.271837 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:45:37.272606 [debug] [Thread-4 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: BEGIN
[0m14:45:37.274003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:45:37.274880 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:37.275594 [debug] [Thread-1 (]: Using postgres connection "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:45:37.275856 [debug] [Thread-3 (]: Using postgres connection "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:45:37.276878 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select units_sold as from_field
    from (select * from "primary_app_db"."public_analytics"."fact_sales" where product_key IS NOT NULL) dbt_subquery
    where units_sold is not null
),

parent as (
    select product_pk as to_field
    from "primary_app_db"."public_analytics"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:45:37.277270 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: BEGIN
[0m14:45:37.277826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:45:37.278610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:37.278878 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.279239 [debug] [Thread-2 (]: Using postgres connection "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:45:37.281891 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: ROLLBACK
[0m14:45:37.282598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m14:45:37.282321 [debug] [Thread-2 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_order_items"
where order_item_pk is not null
group by order_item_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:37.282983 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: Close
[0m14:45:37.283276 [debug] [Thread-4 (]: Using postgres connection "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:45:37.283927 [info ] [Thread-1 (]: 17 of 21 PASS relationships_fact_sales_units_sold__product_pk__ref_dim_products_  [[32mPASS[0m in 0.05s]
[0m14:45:37.284656 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.284942 [debug] [Thread-4 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_orders"
where order_pk is not null
group by order_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:37.285434 [debug] [Thread-1 (]: Finished running node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:45:37.285703 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:45:37.286837 [debug] [Thread-2 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: ROLLBACK
[0m14:45:37.287311 [debug] [Thread-1 (]: Began running node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:45:37.287687 [debug] [Thread-3 (]: Using postgres connection "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:45:37.288002 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.288242 [debug] [Thread-2 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: Close
[0m14:45:37.288516 [info ] [Thread-1 (]: 21 of 21 START test unique_stg_products_product_sku ............................ [RUN]
[0m14:45:37.288925 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_products_product_pk.954d888382"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_products"
where product_pk is not null
group by product_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:37.290047 [debug] [Thread-4 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: ROLLBACK
[0m14:45:37.290527 [info ] [Thread-2 (]: 18 of 21 PASS unique_stg_order_items_order_item_pk ............................. [[32mPASS[0m in 0.04s]
[0m14:45:37.292904 [debug] [Thread-2 (]: Finished running node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:45:37.292156 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.292515 [debug] [Thread-4 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: Close
[0m14:45:37.290923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb, now test.data_models.unique_stg_products_product_sku.ad8bf684d5)
[0m14:45:37.294152 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: ROLLBACK
[0m14:45:37.294643 [info ] [Thread-4 (]: 19 of 21 PASS unique_stg_orders_order_pk ....................................... [[32mPASS[0m in 0.04s]
[0m14:45:37.294966 [debug] [Thread-1 (]: Began compiling node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:45:37.295364 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: Close
[0m14:45:37.295801 [debug] [Thread-4 (]: Finished running node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:45:37.298789 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:45:37.299289 [info ] [Thread-3 (]: 20 of 21 PASS unique_stg_products_product_pk ................................... [[32mPASS[0m in 0.04s]
[0m14:45:37.300432 [debug] [Thread-3 (]: Finished running node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:45:37.300957 [debug] [Thread-1 (]: Began executing node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:45:37.302421 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:45:37.303077 [debug] [Thread-1 (]: Using postgres connection "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:45:37.303358 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: BEGIN
[0m14:45:37.303681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.308582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:45:37.308862 [debug] [Thread-1 (]: Using postgres connection "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:45:37.309179 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_products_product_sku.ad8bf684d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_sku as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_products"
where product_sku is not null
group by product_sku
having count(*) > 1



      
    ) dbt_internal_test
[0m14:45:37.310452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:37.311764 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: ROLLBACK
[0m14:45:37.312214 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: Close
[0m14:45:37.312739 [info ] [Thread-1 (]: 21 of 21 PASS unique_stg_products_product_sku .................................. [[32mPASS[0m in 0.02s]
[0m14:45:37.313274 [debug] [Thread-1 (]: Finished running node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:45:37.315058 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:37.315387 [debug] [MainThread]: On master: BEGIN
[0m14:45:37.315691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:37.320683 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:45:37.321001 [debug] [MainThread]: On master: COMMIT
[0m14:45:37.321285 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:37.321560 [debug] [MainThread]: On master: COMMIT
[0m14:45:37.321902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:37.322189 [debug] [MainThread]: On master: Close
[0m14:45:37.322559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:37.322838 [debug] [MainThread]: Connection 'test.data_models.unique_stg_products_product_sku.ad8bf684d5' was properly closed.
[0m14:45:37.323101 [debug] [MainThread]: Connection 'test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7' was properly closed.
[0m14:45:37.323359 [debug] [MainThread]: Connection 'test.data_models.unique_stg_products_product_pk.954d888382' was properly closed.
[0m14:45:37.323603 [debug] [MainThread]: Connection 'test.data_models.unique_stg_orders_order_pk.11e6f1ee83' was properly closed.
[0m14:45:37.324067 [info ] [MainThread]: 
[0m14:45:37.324390 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:45:37.327241 [debug] [MainThread]: Command end result
[0m14:45:37.385766 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:45:37.387377 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:45:37.394588 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:45:37.394909 [info ] [MainThread]: 
[0m14:45:37.395257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:37.395593 [info ] [MainThread]: 
[0m14:45:37.396019 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m14:45:37.397306 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.163115, "process_in_blocks": "0", "process_kernel_time": 0.136244, "process_mem_max_rss": "131544", "process_out_blocks": "2618", "process_user_time": 1.984556}
[0m14:45:37.397784 [debug] [MainThread]: Command `dbt test` succeeded at 14:45:37.397691 after 1.16 seconds
[0m14:45:37.398084 [debug] [MainThread]: Flushing usage events


============================== 14:49:09.109188 | c722b708-8987-4c80-b3c6-2d2687fd386c ==============================
[0m14:49:09.109188 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:49:09.119254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --target prod', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m14:49:09.119845 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:49:09.266956 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wnajwxsv'
[0m14:49:09.267433 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:49:09.389230 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:49:09.390821 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:49:09.421186 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:49:09.424886 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:49:09.991924 [info ] [MainThread]: Installed from version 1.1.1
[0m14:49:09.992804 [info ] [MainThread]: Updated version available: 1.3.1
[0m14:49:09.993338 [info ] [MainThread]: 
[0m14:49:09.994294 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:49:09.997215 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.955685, "process_in_blocks": "0", "process_kernel_time": 0.168837, "process_mem_max_rss": "105224", "process_out_blocks": "740", "process_user_time": 1.288392}
[0m14:49:09.997862 [debug] [MainThread]: Command `dbt deps` succeeded at 14:49:09.997718 after 0.96 seconds
[0m14:49:09.998227 [debug] [MainThread]: Flushing usage events


============================== 14:49:11.612546 | a6064f05-bd05-4777-b454-d36fb0361c33 ==============================
[0m14:49:11.612546 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:49:11.621080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target prod', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m14:49:11.621809 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:49:11.878909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:11.962473 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:49:12.123284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:12.123790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:12.253071 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:49:12.256029 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:49:12.272006 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:49:12.274191 [info ] [MainThread]: 
[0m14:49:12.274599 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:49:12.274975 [info ] [MainThread]: 
[0m14:49:12.275544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:12.280410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:49:12.288267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db'
[0m14:49:12.338473 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:49:12.339400 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:49:12.338958 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db"
[0m14:49:12.340229 [debug] [ThreadPool]: On list_primary_app_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db"} */

    select distinct nspname from pg_namespace
  
[0m14:49:12.339855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:12.340543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:12.404106 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.064 seconds
[0m14:49:12.404743 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.064 seconds
[0m14:49:12.406432 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:49:12.407565 [debug] [ThreadPool]: On list_primary_app_db: Close
[0m14:49:12.410267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_analytics)
[0m14:49:12.410815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_primary_app_db, now list_primary_app_db_public_staging)
[0m14:49:12.415683 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:49:12.417303 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:49:12.417879 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:49:12.418229 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:49:12.418573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:12.418888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:12.427055 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:49:12.427574 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:49:12.428112 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:49:12.428531 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:49:12.428872 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:49:12.429266 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:49:12.432703 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:49:12.433080 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m14:49:12.434312 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:49:12.435373 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:49:12.435914 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:49:12.436277 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:49:12.442836 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.443350 [debug] [MainThread]: On master: BEGIN
[0m14:49:12.443685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:12.462392 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:49:12.463150 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.463937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:12.469711 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m14:49:12.471497 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:12.472026 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.472402 [debug] [MainThread]: On master: BEGIN
[0m14:49:12.472956 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:49:12.473299 [debug] [MainThread]: On master: COMMIT
[0m14:49:12.473644 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.473966 [debug] [MainThread]: On master: COMMIT
[0m14:49:12.474384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:12.474758 [debug] [MainThread]: On master: Close
[0m14:49:12.477230 [debug] [Thread-1 (]: Began running node model.data_models.stg_order_items
[0m14:49:12.477589 [debug] [Thread-2 (]: Began running node model.data_models.stg_orders
[0m14:49:12.478044 [debug] [Thread-3 (]: Began running node model.data_models.stg_products
[0m14:49:12.478787 [info ] [Thread-1 (]: 1 of 5 START sql view model public_staging.stg_order_items ..................... [RUN]
[0m14:49:12.479546 [info ] [Thread-2 (]: 2 of 5 START sql view model public_staging.stg_orders .......................... [RUN]
[0m14:49:12.480073 [info ] [Thread-3 (]: 3 of 5 START sql view model public_staging.stg_products ........................ [RUN]
[0m14:49:12.480691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now model.data_models.stg_order_items)
[0m14:49:12.481539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now model.data_models.stg_orders)
[0m14:49:12.482406 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.data_models.stg_products'
[0m14:49:12.482840 [debug] [Thread-1 (]: Began compiling node model.data_models.stg_order_items
[0m14:49:12.483350 [debug] [Thread-2 (]: Began compiling node model.data_models.stg_orders
[0m14:49:12.483766 [debug] [Thread-3 (]: Began compiling node model.data_models.stg_products
[0m14:49:12.490318 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_models.stg_order_items"
[0m14:49:12.493873 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_models.stg_orders"
[0m14:49:12.497475 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.stg_products"
[0m14:49:12.500443 [debug] [Thread-3 (]: Began executing node model.data_models.stg_products
[0m14:49:12.500769 [debug] [Thread-1 (]: Began executing node model.data_models.stg_order_items
[0m14:49:12.501053 [debug] [Thread-2 (]: Began executing node model.data_models.stg_orders
[0m14:49:12.531995 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_models.stg_order_items"
[0m14:49:12.533749 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.stg_products"
[0m14:49:12.536121 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_models.stg_orders"
[0m14:49:12.537938 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.538275 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.538595 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.538844 [debug] [Thread-1 (]: On model.data_models.stg_order_items: BEGIN
[0m14:49:12.539171 [debug] [Thread-3 (]: On model.data_models.stg_products: BEGIN
[0m14:49:12.539509 [debug] [Thread-2 (]: On model.data_models.stg_orders: BEGIN
[0m14:49:12.539816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:12.540112 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:12.540439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:12.546794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m14:49:12.547418 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:49:12.548233 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.548984 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */

  create view "primary_app_db"."public_staging"."stg_orders__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_orders.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_pk,
    customer_id,
    
    -- 2. Cleaning and Standardization
    TRIM(order_status) AS order_status, -- Remove accidental whitespace
    
    -- 3. Timestamp Standardization
    order_timestamp,
    
    -- 4. Type Casting
    CAST(total_paid AS NUMERIC(10, 2)) AS total_paid_amount,
    
    -- 5. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_orders"
  );
[0m14:49:12.548591 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.549501 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */

  create view "primary_app_db"."public_staging"."stg_products__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_products.sql

-- Set the materialization as view for quick development/light queries


SELECT
    -- 1. Primary Key/Identifier Renaming
    id AS product_pk, -- 'pk' for primary key in the source system (raw table)
    
    -- 2. Cleaning and Standardizing Identifiers
    UPPER(product_sku) AS product_sku, -- Ensure SKUs are consistently uppercase
    
    -- 3. Core Attributes (Simple pass-through)
    product_name,
    category_id,
    
    -- 4. Type Casting/Formatting
    CAST(unit_price AS NUMERIC(10, 2)) AS unit_price,
    current_stock,
    is_active,
    
    -- 5. Timestamp Standardization
    created_timestamp,
    
    -- 6. Source Metadata (Useful for data lineage/debugging)
    'postgres_raw' AS source_system
    
FROM
    -- Reference the RAW table in the PostgreSQL database
    "primary_app_db"."public"."raw_products"
  );
[0m14:49:12.550937 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:49:12.556409 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.556736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:49:12.556989 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:49:12.557324 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:49:12.557676 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.560397 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */

  create view "primary_app_db"."public_staging"."stg_order_items__dbt_tmp"
    
    
  as (
    -- data_models/models/staging/stg_order_items.sql



SELECT
    -- 1. Identifier Renaming
    id AS order_item_pk,
    order_id AS order_pk,
    product_id AS product_pk,

    -- 2. Type Casting and Validation
    quantity,
    CAST(unit_price_at_sale AS NUMERIC(10, 2)) AS unit_price_at_sale,
    
    -- 3. Source Metadata
    'postgres_raw' AS source_system
    
FROM
    "primary_app_db"."public"."raw_order_items"
  );
[0m14:49:12.559893 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.560689 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.561124 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m14:49:12.563399 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.563686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:49:12.564128 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
alter table "primary_app_db"."public_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:49:12.564419 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.566408 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.569941 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m14:49:12.569598 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:49:12.569333 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.582638 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:49:12.582936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m14:49:12.583282 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
alter table "primary_app_db"."public_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:49:12.583649 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.585742 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.586213 [debug] [Thread-2 (]: On model.data_models.stg_orders: COMMIT
[0m14:49:12.586490 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.586796 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
alter table "primary_app_db"."public_staging"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m14:49:12.588058 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:49:12.588612 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.588882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.589159 [debug] [Thread-3 (]: On model.data_models.stg_products: COMMIT
[0m14:49:12.589400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:49:12.590500 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:49:12.595500 [debug] [Thread-2 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_orders__dbt_backup"
[0m14:49:12.595796 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m14:49:12.596058 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.599846 [debug] [Thread-2 (]: Using postgres connection "model.data_models.stg_orders"
[0m14:49:12.601516 [debug] [Thread-3 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_products__dbt_backup"
[0m14:49:12.601809 [debug] [Thread-1 (]: On model.data_models.stg_order_items: COMMIT
[0m14:49:12.602140 [debug] [Thread-2 (]: On model.data_models.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_orders"} */
drop view if exists "primary_app_db"."public_staging"."stg_orders__dbt_backup" cascade
[0m14:49:12.602696 [debug] [Thread-3 (]: Using postgres connection "model.data_models.stg_products"
[0m14:49:12.603315 [debug] [Thread-3 (]: On model.data_models.stg_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_products"} */
drop view if exists "primary_app_db"."public_staging"."stg_products__dbt_backup" cascade
[0m14:49:12.603636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:12.605790 [debug] [Thread-1 (]: Applying DROP to: "primary_app_db"."public_staging"."stg_order_items__dbt_backup"
[0m14:49:12.606125 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:49:12.606423 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:49:12.606874 [debug] [Thread-1 (]: Using postgres connection "model.data_models.stg_order_items"
[0m14:49:12.609068 [debug] [Thread-2 (]: On model.data_models.stg_orders: Close
[0m14:49:12.610201 [debug] [Thread-3 (]: On model.data_models.stg_products: Close
[0m14:49:12.610512 [debug] [Thread-1 (]: On model.data_models.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.stg_order_items"} */
drop view if exists "primary_app_db"."public_staging"."stg_order_items__dbt_backup" cascade
[0m14:49:12.613012 [info ] [Thread-2 (]: 2 of 5 OK created sql view model public_staging.stg_orders ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:49:12.613625 [info ] [Thread-3 (]: 3 of 5 OK created sql view model public_staging.stg_products ................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:49:12.614525 [debug] [Thread-2 (]: Finished running node model.data_models.stg_orders
[0m14:49:12.614826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:49:12.615224 [debug] [Thread-3 (]: Finished running node model.data_models.stg_products
[0m14:49:12.616643 [debug] [Thread-1 (]: On model.data_models.stg_order_items: Close
[0m14:49:12.617442 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public_staging.stg_order_items ................ [[32mCREATE VIEW[0m in 0.14s]
[0m14:49:12.617817 [debug] [Thread-4 (]: Began running node model.data_models.dim_products
[0m14:49:12.618289 [debug] [Thread-1 (]: Finished running node model.data_models.stg_order_items
[0m14:49:12.618690 [info ] [Thread-4 (]: 4 of 5 START sql table model public_analytics.dim_products ..................... [RUN]
[0m14:49:12.619358 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.data_models.dim_products'
[0m14:49:12.619676 [debug] [Thread-4 (]: Began compiling node model.data_models.dim_products
[0m14:49:12.622581 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_models.dim_products"
[0m14:49:12.624335 [debug] [Thread-4 (]: Began executing node model.data_models.dim_products
[0m14:49:12.641044 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_models.dim_products"
[0m14:49:12.641985 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.642296 [debug] [Thread-4 (]: On model.data_models.dim_products: BEGIN
[0m14:49:12.642583 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:12.647993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m14:49:12.648301 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.648605 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */

  
    

  create  table "primary_app_db"."public_analytics"."dim_products__dbt_tmp"
  
  
    as
  
  (
    -- data_models/models/marts/dim_products.sql

-- Materialize as a table for fast read performance in Power BI


SELECT
    -- Final Unique Identifier for Power BI (Dimension Key)
    product_pk, 
    
    -- Core Product Attributes
    product_sku,
    product_name,
    
    -- Descriptive Attributes
    CASE
        WHEN category_id = 1 THEN 'Electronics'
        WHEN category_id = 2 THEN 'Apparel'
        ELSE 'Other' 
    END AS product_category_name, -- Logic to translate raw FK to a user-friendly name
    
    -- Price and Status
    unit_price AS current_unit_price,
    current_stock,
    is_active,
    
    -- Metadata/History
    created_timestamp
    
FROM
    "primary_app_db"."public_staging"."stg_products"

-- Optional: Add a unique constraint check to ensure dimension integrity
-- You would typically add this to a 'schema.yml' file for testing
  );
  
[0m14:49:12.651681 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m14:49:12.653981 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.654267 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products" rename to "dim_products__dbt_backup"
[0m14:49:12.654709 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.657553 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.657848 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
alter table "primary_app_db"."public_analytics"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:49:12.658268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:12.662032 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:49:12.662316 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.662570 [debug] [Thread-4 (]: On model.data_models.dim_products: COMMIT
[0m14:49:12.663219 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m14:49:12.664774 [debug] [Thread-4 (]: Applying DROP to: "primary_app_db"."public_analytics"."dim_products__dbt_backup"
[0m14:49:12.666773 [debug] [Thread-4 (]: Using postgres connection "model.data_models.dim_products"
[0m14:49:12.667059 [debug] [Thread-4 (]: On model.data_models.dim_products: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.dim_products"} */
drop table if exists "primary_app_db"."public_analytics"."dim_products__dbt_backup" cascade
[0m14:49:12.671897 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:49:12.673506 [debug] [Thread-4 (]: On model.data_models.dim_products: Close
[0m14:49:12.674292 [info ] [Thread-4 (]: 4 of 5 OK created sql table model public_analytics.dim_products ................ [[32mSELECT 0[0m in 0.05s]
[0m14:49:12.674921 [debug] [Thread-4 (]: Finished running node model.data_models.dim_products
[0m14:49:12.676375 [debug] [Thread-3 (]: Began running node model.data_models.fact_sales
[0m14:49:12.688925 [info ] [Thread-3 (]: 5 of 5 START sql incremental model public_analytics.fact_sales ................. [RUN]
[0m14:49:12.689566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_models.stg_products, now model.data_models.fact_sales)
[0m14:49:12.690046 [debug] [Thread-3 (]: Began compiling node model.data_models.fact_sales
[0m14:49:12.701923 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_models.fact_sales"
[0m14:49:12.703014 [debug] [Thread-3 (]: Began executing node model.data_models.fact_sales
[0m14:49:12.727292 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.727876 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

    
  
    

  create temporary table "fact_sales__dbt_tmp144912722937"
  
  
    as
  
  (
    -- data_models/models/marts/fact_sales.sql

-- Materialize as a table for the best query performance in Power BI


WITH items AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_order_items" 
),

orders AS (
    SELECT * FROM "primary_app_db"."public_staging"."stg_orders"
),

products AS (
    -- Reference the clean dimension table to pull in descriptive data
    SELECT 
        product_pk, 
        product_sku,
        product_category_name -- Pulling the clean, categorized name from dim_products
    FROM 
        "primary_app_db"."public_analytics"."dim_products"
)

SELECT
    -- 1. Foreign Keys (To link to the Dimension Tables)
    o.order_pk AS order_key,
    o.customer_id AS customer_key, -- Assumes a dim_customers table for lookup
    i.product_pk AS product_key,

    -- 2. Date/Time Dimensions (For temporal slicing and dicing)
    o.order_timestamp AS sales_timestamp,
    CAST(o.order_timestamp AS DATE) AS sales_date, -- For easy date filtering

    -- 3. Measures (The core business metrics to be aggregated)
    i.quantity AS units_sold,
    i.unit_price_at_sale,
    (i.quantity * i.unit_price_at_sale) AS gross_revenue_amount,
    
    -- 4. Descriptive Attributes (Denormalized into the fact for reporting convenience)
    p.product_sku,
    p.product_category_name,

    -- 5. Status and Lineage
    o.order_status,
    o.source_system AS source_system
    
FROM
    items i
INNER JOIN
    orders o 
    ON i.order_pk = o.order_pk
LEFT JOIN
    products p
    ON i.product_pk = p.product_pk

WHERE
    -- CRITICAL BUSINESS LOGIC: Ensure data integrity by only including transactions that are completed
    o.order_status = 'Delivered' 
    -- Filter out any future-dated orders or garbage data
    AND o.order_timestamp <= NOW()

    
    -- Only process records newer than the latest already built
    AND o.order_timestamp > (
        SELECT COALESCE(MAX(sales_timestamp), TIMESTAMP '1900-01-01') FROM "primary_app_db"."public_analytics"."fact_sales"
    )
    
  );
  
  
[0m14:49:12.728362 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:12.736400 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.008 seconds
[0m14:49:12.746312 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.746762 [debug] [Thread-3 (]: On model.data_models.fact_sales: BEGIN
[0m14:49:12.747368 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m14:49:12.747748 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.748078 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144912722937'
        
      order by ordinal_position

  
[0m14:49:12.753107 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.005 seconds
[0m14:49:12.757620 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.758009 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:49:12.759788 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:49:12.775981 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.776355 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales__dbt_tmp144912722937'
        
      order by ordinal_position

  
[0m14:49:12.778086 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:49:12.780497 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.780869 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "primary_app_db".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'public_analytics'
        
      order by ordinal_position

  
[0m14:49:12.782593 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.001 seconds
[0m14:49:12.789743 [debug] [Thread-3 (]: 
    In "primary_app_db"."public_analytics"."fact_sales":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:49:12.803980 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_models.fact_sales"
[0m14:49:12.805136 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.805567 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

      
        
            delete from "primary_app_db"."public_analytics"."fact_sales"
            using "fact_sales__dbt_tmp144912722937"
            where (
                
                    "fact_sales__dbt_tmp144912722937".order_key = "primary_app_db"."public_analytics"."fact_sales".order_key
                    and 
                
                    "fact_sales__dbt_tmp144912722937".product_key = "primary_app_db"."public_analytics"."fact_sales".product_key
                    
                
                
            );
        
    

    insert into "primary_app_db"."public_analytics"."fact_sales" ("order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system")
    (
        select "order_key", "customer_key", "product_key", "sales_timestamp", "sales_date", "units_sold", "unit_price_at_sale", "gross_revenue_amount", "product_sku", "product_category_name", "order_status", "source_system"
        from "fact_sales__dbt_tmp144912722937"
    )
  
[0m14:49:12.806654 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m14:49:12.808335 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.808653 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_sales_date ON "primary_app_db"."public_analytics"."fact_sales" (sales_date)
      
[0m14:49:12.809672 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m14:49:12.810854 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.811191 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_product_key ON "primary_app_db"."public_analytics"."fact_sales" (product_key)
      
[0m14:49:12.811637 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:49:12.812717 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.813021 [debug] [Thread-3 (]: On model.data_models.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "model.data_models.fact_sales"} */

        CREATE INDEX IF NOT EXISTS idx_fact_sales_order_key ON "primary_app_db"."public_analytics"."fact_sales" (order_key)
      
[0m14:49:12.813512 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m14:49:12.814374 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:49:12.814683 [debug] [Thread-3 (]: Using postgres connection "model.data_models.fact_sales"
[0m14:49:12.814990 [debug] [Thread-3 (]: On model.data_models.fact_sales: COMMIT
[0m14:49:12.815779 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:49:12.816418 [debug] [Thread-3 (]: On model.data_models.fact_sales: Close
[0m14:49:12.817171 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model public_analytics.fact_sales ............ [[32mINSERT 0 0[0m in 0.13s]
[0m14:49:12.819759 [debug] [Thread-3 (]: Finished running node model.data_models.fact_sales
[0m14:49:12.821172 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.821526 [debug] [MainThread]: On master: BEGIN
[0m14:49:12.821810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:12.827264 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:49:12.828433 [debug] [MainThread]: On master: COMMIT
[0m14:49:12.828815 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:12.829114 [debug] [MainThread]: On master: COMMIT
[0m14:49:12.829503 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:12.829797 [debug] [MainThread]: On master: Close
[0m14:49:12.830198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:12.830485 [debug] [MainThread]: Connection 'model.data_models.stg_order_items' was properly closed.
[0m14:49:12.830766 [debug] [MainThread]: Connection 'model.data_models.stg_orders' was properly closed.
[0m14:49:12.831030 [debug] [MainThread]: Connection 'model.data_models.fact_sales' was properly closed.
[0m14:49:12.831275 [debug] [MainThread]: Connection 'model.data_models.dim_products' was properly closed.
[0m14:49:12.831824 [info ] [MainThread]: 
[0m14:49:12.832174 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m14:49:12.833515 [debug] [MainThread]: Command end result
[0m14:49:12.865476 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:49:12.867176 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:49:12.872774 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:49:12.873048 [info ] [MainThread]: 
[0m14:49:12.873400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:12.873709 [info ] [MainThread]: 
[0m14:49:12.874123 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:49:12.875503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3458517, "process_in_blocks": "0", "process_kernel_time": 0.239697, "process_mem_max_rss": "129912", "process_out_blocks": "2527", "process_user_time": 2.376659}
[0m14:49:12.876482 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:12.876337 after 1.35 seconds
[0m14:49:12.878634 [debug] [MainThread]: Flushing usage events


============================== 14:49:14.092258 | 78c00e65-6b41-43f4-b0b2-46ebfa3d224e ==============================
[0m14:49:14.092258 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:49:14.099641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --target prod', 'send_anonymous_usage_stats': 'False'}
[0m14:49:14.100281 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:49:14.285987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:14.363422 [debug] [MainThread]: checksum: 5e136c6ef973c3d2d7bca0f5b88d13d58073133b7e7d38a3e8d0aac8e6391733, vars: {}, profile: , target: prod, version: 1.9.0
[0m14:49:14.489165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:14.489631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:14.624767 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:49:14.628174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:49:14.659261 [info ] [MainThread]: Found 5 models, 21 data tests, 3 sources, 543 macros
[0m14:49:14.664516 [info ] [MainThread]: 
[0m14:49:14.666267 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:49:14.669037 [info ] [MainThread]: 
[0m14:49:14.670652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:14.676884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db_public_analytics'
[0m14:49:14.687386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_primary_app_db_public_staging'
[0m14:49:14.708464 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:49:14.708846 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:49:14.709232 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: BEGIN
[0m14:49:14.709562 [debug] [ThreadPool]: On list_primary_app_db_public_staging: BEGIN
[0m14:49:14.709908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:14.710227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:14.788237 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m14:49:14.788778 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m14:49:14.789245 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_analytics"
[0m14:49:14.789619 [debug] [ThreadPool]: Using postgres connection "list_primary_app_db_public_staging"
[0m14:49:14.790026 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_analytics"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m14:49:14.790407 [debug] [ThreadPool]: On list_primary_app_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "list_primary_app_db_public_staging"} */
select
      'primary_app_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'primary_app_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:49:14.793223 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:49:14.793522 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m14:49:14.795236 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: ROLLBACK
[0m14:49:14.796845 [debug] [ThreadPool]: On list_primary_app_db_public_staging: ROLLBACK
[0m14:49:14.797545 [debug] [ThreadPool]: On list_primary_app_db_public_analytics: Close
[0m14:49:14.797947 [debug] [ThreadPool]: On list_primary_app_db_public_staging: Close
[0m14:49:14.804418 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:14.804820 [debug] [MainThread]: On master: BEGIN
[0m14:49:14.805136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:14.810692 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:49:14.811245 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:14.811795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:14.815192 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m14:49:14.816605 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:14.817043 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:14.817332 [debug] [MainThread]: On master: BEGIN
[0m14:49:14.817788 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:49:14.818169 [debug] [MainThread]: On master: COMMIT
[0m14:49:14.818523 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:14.818835 [debug] [MainThread]: On master: COMMIT
[0m14:49:14.819225 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:14.819517 [debug] [MainThread]: On master: Close
[0m14:49:14.822199 [debug] [Thread-1 (]: Began running node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:49:14.822543 [debug] [Thread-2 (]: Began running node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:49:14.822847 [debug] [Thread-3 (]: Began running node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:49:14.823184 [debug] [Thread-4 (]: Began running node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:49:14.823528 [info ] [Thread-1 (]: 1 of 21 START test dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_  [RUN]
[0m14:49:14.823975 [info ] [Thread-2 (]: 2 of 21 START test dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0  [RUN]
[0m14:49:14.824425 [info ] [Thread-3 (]: 3 of 21 START test dbt_utils_expression_is_true_fact_sales_units_sold_0 ........ [RUN]
[0m14:49:14.824829 [info ] [Thread-4 (]: 4 of 21 START test dbt_utils_expression_is_true_stg_order_items_quantity_0 ..... [RUN]
[0m14:49:14.826212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_staging, now test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9)
[0m14:49:14.826635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_primary_app_db_public_analytics, now test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720)
[0m14:49:14.827172 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7'
[0m14:49:14.827799 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01'
[0m14:49:14.828228 [debug] [Thread-1 (]: Began compiling node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:49:14.828691 [debug] [Thread-2 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:49:14.829106 [debug] [Thread-3 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:49:14.829512 [debug] [Thread-4 (]: Began compiling node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:49:14.847194 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:49:14.856097 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:49:14.859936 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:49:14.863706 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:49:14.865254 [debug] [Thread-1 (]: Began executing node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:49:14.871983 [debug] [Thread-3 (]: Began executing node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:49:14.872305 [debug] [Thread-2 (]: Began executing node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:49:14.877816 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:49:14.879492 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:49:14.879991 [debug] [Thread-4 (]: Began executing node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:49:14.881381 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:49:14.883654 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:49:14.884294 [debug] [Thread-1 (]: Using postgres connection "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:49:14.884751 [debug] [Thread-3 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:49:14.885149 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: BEGIN
[0m14:49:14.885456 [debug] [Thread-2 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:49:14.885790 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: BEGIN
[0m14:49:14.886160 [debug] [Thread-4 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:49:14.886440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:14.886776 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: BEGIN
[0m14:49:14.887887 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:14.887399 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: BEGIN
[0m14:49:14.887083 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:14.888764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:14.894715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:14.896257 [debug] [Thread-1 (]: Using postgres connection "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"
[0m14:49:14.895992 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m14:49:14.895541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m14:49:14.896633 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "primary_app_db"."public_analytics"."fact_sales"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sales_timestamp >= '2000-01-01'
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sales_timestamp <= NOW()
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m14:49:14.897021 [debug] [Thread-4 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"
[0m14:49:14.897796 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_staging"."stg_order_items"

where not(quantity > 0)


      
    ) dbt_internal_test
[0m14:49:14.897325 [debug] [Thread-2 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"
[0m14:49:14.898546 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_analytics"."fact_sales"

where not(gross_revenue_amount >= 0)


      
    ) dbt_internal_test
[0m14:49:14.898895 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.899424 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.899698 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:49:14.903944 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: ROLLBACK
[0m14:49:14.904556 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:49:14.905888 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: ROLLBACK
[0m14:49:14.906339 [debug] [Thread-3 (]: Using postgres connection "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"
[0m14:49:14.906867 [debug] [Thread-1 (]: On test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9: Close
[0m14:49:14.908014 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: ROLLBACK
[0m14:49:14.908457 [debug] [Thread-4 (]: On test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01: Close
[0m14:49:14.908770 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "primary_app_db"."public_analytics"."fact_sales"

where not(units_sold > 0)


      
    ) dbt_internal_test
[0m14:49:14.909454 [info ] [Thread-1 (]: 1 of 21 PASS dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_  [[32mPASS[0m in 0.08s]
[0m14:49:14.910099 [debug] [Thread-2 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720: Close
[0m14:49:14.910571 [info ] [Thread-4 (]: 4 of 21 PASS dbt_utils_expression_is_true_stg_order_items_quantity_0 ........... [[32mPASS[0m in 0.08s]
[0m14:49:14.911999 [debug] [Thread-1 (]: Finished running node test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9
[0m14:49:14.912352 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.912913 [info ] [Thread-2 (]: 2 of 21 PASS dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0 .... [[32mPASS[0m in 0.09s]
[0m14:49:14.913484 [debug] [Thread-4 (]: Finished running node test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01
[0m14:49:14.913908 [debug] [Thread-1 (]: Began running node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:49:14.915391 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: ROLLBACK
[0m14:49:14.915920 [debug] [Thread-2 (]: Finished running node test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720
[0m14:49:14.916282 [debug] [Thread-4 (]: Began running node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:49:14.916692 [info ] [Thread-1 (]: 5 of 21 START test not_null_dim_products_product_pk ............................ [RUN]
[0m14:49:14.917224 [debug] [Thread-2 (]: Began running node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:49:14.917489 [debug] [Thread-3 (]: On test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7: Close
[0m14:49:14.917845 [info ] [Thread-4 (]: 6 of 21 START test not_null_dim_products_product_sku ........................... [RUN]
[0m14:49:14.918265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_accepted_range_fact_sales_sales_timestamp__NOW____2000_01_01_.401a9e99e9, now test.data_models.not_null_dim_products_product_pk.ff139bf0d7)
[0m14:49:14.918617 [info ] [Thread-2 (]: 7 of 21 START test not_null_fact_sales_gross_revenue_amount .................... [RUN]
[0m14:49:14.919149 [info ] [Thread-3 (]: 3 of 21 PASS dbt_utils_expression_is_true_fact_sales_units_sold_0 .............. [[32mPASS[0m in 0.09s]
[0m14:49:14.919515 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_stg_order_items_quantity_0.243b3bbe01, now test.data_models.not_null_dim_products_product_sku.1098c1a343)
[0m14:49:14.919888 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:49:14.920242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_fact_sales_gross_revenue_amount_0.ac79271720, now test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d)
[0m14:49:14.920799 [debug] [Thread-3 (]: Finished running node test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7
[0m14:49:14.921152 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:49:14.927286 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:49:14.927617 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:49:14.928013 [debug] [Thread-3 (]: Began running node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:49:14.930610 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:49:14.935421 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:49:14.936919 [info ] [Thread-3 (]: 8 of 21 START test not_null_fact_sales_order_key ............................... [RUN]
[0m14:49:14.937423 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:49:14.938355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.dbt_utils_expression_is_true_fact_sales_units_sold_0.b59cefe3c7, now test.data_models.not_null_fact_sales_order_key.ac23b4dcda)
[0m14:49:14.939128 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:49:14.942276 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:49:14.943161 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:49:14.943608 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:49:14.945710 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:49:14.947757 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:49:14.952027 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:49:14.953067 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:49:14.954376 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:49:14.955071 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: BEGIN
[0m14:49:14.955362 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:49:14.956028 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:49:14.956337 [debug] [Thread-4 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: BEGIN
[0m14:49:14.959294 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:14.957099 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: BEGIN
[0m14:49:14.958955 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:49:14.956689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:14.959959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:14.962396 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:49:14.963057 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: BEGIN
[0m14:49:14.964669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:14.968236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:14.968676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:49:14.969349 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:14.970067 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"
[0m14:49:14.970504 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"
[0m14:49:14.970897 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_dim_products_product_sku.1098c1a343"
[0m14:49:14.971287 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select gross_revenue_amount
from "primary_app_db"."public_analytics"."fact_sales"
where gross_revenue_amount is null



      
    ) dbt_internal_test
[0m14:49:14.971829 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_dim_products_product_pk.ff139bf0d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_pk
from "primary_app_db"."public_analytics"."dim_products"
where product_pk is null



      
    ) dbt_internal_test
[0m14:49:14.972351 [debug] [Thread-4 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_dim_products_product_sku.1098c1a343"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sku
from "primary_app_db"."public_analytics"."dim_products"
where product_sku is null



      
    ) dbt_internal_test
[0m14:49:14.972690 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:14.973960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.974487 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.974949 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.975252 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"
[0m14:49:14.977045 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: ROLLBACK
[0m14:49:14.978870 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: ROLLBACK
[0m14:49:14.980284 [debug] [Thread-4 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: ROLLBACK
[0m14:49:14.980687 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_order_key.ac23b4dcda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from "primary_app_db"."public_analytics"."fact_sales"
where order_key is null



      
    ) dbt_internal_test
[0m14:49:14.981316 [debug] [Thread-1 (]: On test.data_models.not_null_dim_products_product_pk.ff139bf0d7: Close
[0m14:49:14.981636 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d: Close
[0m14:49:14.982165 [debug] [Thread-4 (]: On test.data_models.not_null_dim_products_product_sku.1098c1a343: Close
[0m14:49:14.982900 [info ] [Thread-1 (]: 5 of 21 PASS not_null_dim_products_product_pk .................................. [[32mPASS[0m in 0.06s]
[0m14:49:14.983667 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:14.984649 [info ] [Thread-2 (]: 7 of 21 PASS not_null_fact_sales_gross_revenue_amount .......................... [[32mPASS[0m in 0.06s]
[0m14:49:14.985651 [info ] [Thread-4 (]: 6 of 21 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 0.07s]
[0m14:49:14.986217 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_dim_products_product_pk.ff139bf0d7
[0m14:49:14.987465 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: ROLLBACK
[0m14:49:14.987929 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d
[0m14:49:14.988445 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_dim_products_product_sku.1098c1a343
[0m14:49:14.988878 [debug] [Thread-1 (]: Began running node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:49:14.989346 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_order_key.ac23b4dcda: Close
[0m14:49:14.989614 [debug] [Thread-2 (]: Began running node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:49:14.989993 [debug] [Thread-4 (]: Began running node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:49:14.990374 [info ] [Thread-1 (]: 9 of 21 START test not_null_fact_sales_product_key ............................. [RUN]
[0m14:49:14.990956 [info ] [Thread-3 (]: 8 of 21 PASS not_null_fact_sales_order_key ..................................... [[32mPASS[0m in 0.05s]
[0m14:49:14.991373 [info ] [Thread-2 (]: 10 of 21 START test not_null_fact_sales_sales_date ............................. [RUN]
[0m14:49:14.991771 [info ] [Thread-4 (]: 11 of 21 START test not_null_fact_sales_sales_timestamp ........................ [RUN]
[0m14:49:14.992203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_dim_products_product_pk.ff139bf0d7, now test.data_models.not_null_fact_sales_product_key.e4fd332b98)
[0m14:49:14.992683 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_fact_sales_order_key.ac23b4dcda
[0m14:49:14.994319 [debug] [Thread-3 (]: Began running node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:49:14.993428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_dim_products_product_sku.1098c1a343, now test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33)
[0m14:49:14.993843 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:49:14.993046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_gross_revenue_amount.2241e8475d, now test.data_models.not_null_fact_sales_sales_date.b9941c8fee)
[0m14:49:15.000105 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:49:14.995140 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:49:14.999593 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:49:14.994672 [info ] [Thread-3 (]: 12 of 21 START test not_null_fact_sales_units_sold ............................. [RUN]
[0m14:49:15.002950 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:49:15.007059 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:49:15.007965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_order_key.ac23b4dcda, now test.data_models.not_null_fact_sales_units_sold.e428e81951)
[0m14:49:15.008674 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:49:15.009352 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:49:15.009625 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:49:15.011562 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:49:15.011998 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:49:15.015032 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:49:15.016590 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:49:15.018370 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:49:15.018919 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:49:15.019851 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:49:15.020113 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: BEGIN
[0m14:49:15.020447 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:49:15.020741 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:49:15.022135 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:49:15.022467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.022849 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: BEGIN
[0m14:49:15.023178 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: BEGIN
[0m14:49:15.023929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:15.024279 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:49:15.024576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:15.025380 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: BEGIN
[0m14:49:15.027299 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:15.030259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:15.031673 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_fact_sales_product_key.e4fd332b98"
[0m14:49:15.032381 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_product_key.e4fd332b98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from "primary_app_db"."public_analytics"."fact_sales"
where product_key is null



      
    ) dbt_internal_test
[0m14:49:15.033038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:49:15.033533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.033807 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"
[0m14:49:15.034282 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:15.035711 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: ROLLBACK
[0m14:49:15.036118 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_sales_date.b9941c8fee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_date
from "primary_app_db"."public_analytics"."fact_sales"
where sales_date is null



      
    ) dbt_internal_test
[0m14:49:15.036489 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"
[0m14:49:15.036885 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:15.037207 [debug] [Thread-1 (]: On test.data_models.not_null_fact_sales_product_key.e4fd332b98: Close
[0m14:49:15.037617 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_timestamp
from "primary_app_db"."public_analytics"."fact_sales"
where sales_timestamp is null



      
    ) dbt_internal_test
[0m14:49:15.037948 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_fact_sales_units_sold.e428e81951"
[0m14:49:15.038196 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.038849 [info ] [Thread-1 (]: 9 of 21 PASS not_null_fact_sales_product_key ................................... [[32mPASS[0m in 0.05s]
[0m14:49:15.039540 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_fact_sales_units_sold.e428e81951"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select units_sold
from "primary_app_db"."public_analytics"."fact_sales"
where units_sold is null



      
    ) dbt_internal_test
[0m14:49:15.039808 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.041024 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: ROLLBACK
[0m14:49:15.041560 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_fact_sales_product_key.e4fd332b98
[0m14:49:15.042928 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: ROLLBACK
[0m14:49:15.043234 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.043640 [debug] [Thread-2 (]: On test.data_models.not_null_fact_sales_sales_date.b9941c8fee: Close
[0m14:49:15.044039 [debug] [Thread-1 (]: Began running node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:49:15.044958 [debug] [Thread-4 (]: On test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33: Close
[0m14:49:15.048265 [info ] [Thread-4 (]: 11 of 21 PASS not_null_fact_sales_sales_timestamp .............................. [[32mPASS[0m in 0.05s]
[0m14:49:15.047000 [info ] [Thread-2 (]: 10 of 21 PASS not_null_fact_sales_sales_date ................................... [[32mPASS[0m in 0.05s]
[0m14:49:15.047645 [info ] [Thread-1 (]: 13 of 21 START test not_null_stg_order_items_order_item_pk ..................... [RUN]
[0m14:49:15.046276 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: ROLLBACK
[0m14:49:15.048809 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33
[0m14:49:15.049290 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_fact_sales_sales_date.b9941c8fee
[0m14:49:15.049673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_product_key.e4fd332b98, now test.data_models.not_null_stg_order_items_order_item_pk.21b2354033)
[0m14:49:15.050104 [debug] [Thread-3 (]: On test.data_models.not_null_fact_sales_units_sold.e428e81951: Close
[0m14:49:15.050421 [debug] [Thread-4 (]: Began running node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:49:15.050847 [debug] [Thread-2 (]: Began running node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:49:15.051185 [debug] [Thread-1 (]: Began compiling node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:49:15.051639 [info ] [Thread-3 (]: 12 of 21 PASS not_null_fact_sales_units_sold ................................... [[32mPASS[0m in 0.04s]
[0m14:49:15.051985 [info ] [Thread-4 (]: 14 of 21 START test not_null_stg_orders_order_pk ............................... [RUN]
[0m14:49:15.052375 [info ] [Thread-2 (]: 15 of 21 START test not_null_stg_products_product_pk ........................... [RUN]
[0m14:49:15.055591 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:49:15.056065 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_fact_sales_units_sold.e428e81951
[0m14:49:15.057442 [debug] [Thread-3 (]: Began running node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:49:15.056767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_sales_date.b9941c8fee, now test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d)
[0m14:49:15.056398 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_sales_timestamp.340b66bf33, now test.data_models.not_null_stg_orders_order_pk.5306dc2b5e)
[0m14:49:15.057834 [info ] [Thread-3 (]: 16 of 21 START test not_null_stg_products_product_sku .......................... [RUN]
[0m14:49:15.058224 [debug] [Thread-2 (]: Began compiling node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:49:15.058492 [debug] [Thread-1 (]: Began executing node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:49:15.058795 [debug] [Thread-4 (]: Began compiling node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:49:15.059189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_fact_sales_units_sold.e428e81951, now test.data_models.not_null_stg_products_product_sku.ae077a8c6f)
[0m14:49:15.063289 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:49:15.065061 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:49:15.067738 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:49:15.068043 [debug] [Thread-3 (]: Began compiling node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:49:15.069184 [debug] [Thread-2 (]: Began executing node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:49:15.069480 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:49:15.073121 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:49:15.073472 [debug] [Thread-4 (]: Began executing node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:49:15.075074 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:49:15.075455 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: BEGIN
[0m14:49:15.077229 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:49:15.077965 [debug] [Thread-3 (]: Began executing node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:49:15.078258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.078792 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:49:15.081353 [debug] [Thread-2 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: BEGIN
[0m14:49:15.081057 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:49:15.080534 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:49:15.081628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:15.081973 [debug] [Thread-4 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: BEGIN
[0m14:49:15.082786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:15.083272 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:49:15.083936 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: BEGIN
[0m14:49:15.084950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:15.086813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:15.088551 [debug] [Thread-1 (]: Using postgres connection "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"
[0m14:49:15.089156 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_order_items_order_item_pk.21b2354033"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_pk
from "primary_app_db"."public_staging"."stg_order_items"
where order_item_pk is null



      
    ) dbt_internal_test
[0m14:49:15.089466 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m14:49:15.090212 [debug] [Thread-4 (]: Using postgres connection "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"
[0m14:49:15.089891 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:15.090801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.091074 [debug] [Thread-4 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_orders_order_pk.5306dc2b5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_pk
from "primary_app_db"."public_staging"."stg_orders"
where order_pk is null



      
    ) dbt_internal_test
[0m14:49:15.091400 [debug] [Thread-2 (]: Using postgres connection "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"
[0m14:49:15.092852 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: ROLLBACK
[0m14:49:15.093124 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m14:49:15.093498 [debug] [Thread-2 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_pk
from "primary_app_db"."public_staging"."stg_products"
where product_pk is null



      
    ) dbt_internal_test
[0m14:49:15.094125 [debug] [Thread-1 (]: On test.data_models.not_null_stg_order_items_order_item_pk.21b2354033: Close
[0m14:49:15.094390 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.094694 [debug] [Thread-3 (]: Using postgres connection "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"
[0m14:49:15.096850 [info ] [Thread-1 (]: 13 of 21 PASS not_null_stg_order_items_order_item_pk ........................... [[32mPASS[0m in 0.05s]
[0m14:49:15.097283 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:49:15.098532 [debug] [Thread-4 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: ROLLBACK
[0m14:49:15.098964 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.not_null_stg_products_product_sku.ae077a8c6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_sku
from "primary_app_db"."public_staging"."stg_products"
where product_sku is null



      
    ) dbt_internal_test
[0m14:49:15.099465 [debug] [Thread-1 (]: Finished running node test.data_models.not_null_stg_order_items_order_item_pk.21b2354033
[0m14:49:15.100642 [debug] [Thread-2 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: ROLLBACK
[0m14:49:15.101104 [debug] [Thread-4 (]: On test.data_models.not_null_stg_orders_order_pk.5306dc2b5e: Close
[0m14:49:15.101548 [debug] [Thread-1 (]: Began running node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:49:15.101993 [debug] [Thread-2 (]: On test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d: Close
[0m14:49:15.102254 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.102679 [info ] [Thread-4 (]: 14 of 21 PASS not_null_stg_orders_order_pk ..................................... [[32mPASS[0m in 0.05s]
[0m14:49:15.103196 [info ] [Thread-1 (]: 17 of 21 START test relationships_fact_sales_units_sold__product_pk__ref_dim_products_  [RUN]
[0m14:49:15.103750 [info ] [Thread-2 (]: 15 of 21 PASS not_null_stg_products_product_pk ................................. [[32mPASS[0m in 0.05s]
[0m14:49:15.105234 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: ROLLBACK
[0m14:49:15.105740 [debug] [Thread-4 (]: Finished running node test.data_models.not_null_stg_orders_order_pk.5306dc2b5e
[0m14:49:15.106118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_order_items_order_item_pk.21b2354033, now test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb)
[0m14:49:15.106574 [debug] [Thread-2 (]: Finished running node test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d
[0m14:49:15.107015 [debug] [Thread-3 (]: On test.data_models.not_null_stg_products_product_sku.ae077a8c6f: Close
[0m14:49:15.107329 [debug] [Thread-4 (]: Began running node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:49:15.107725 [debug] [Thread-1 (]: Began compiling node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:49:15.108095 [debug] [Thread-2 (]: Began running node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:49:15.108614 [info ] [Thread-3 (]: 16 of 21 PASS not_null_stg_products_product_sku ................................ [[32mPASS[0m in 0.05s]
[0m14:49:15.108966 [info ] [Thread-4 (]: 18 of 21 START test unique_stg_order_items_order_item_pk ....................... [RUN]
[0m14:49:15.117400 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:49:15.117873 [info ] [Thread-2 (]: 19 of 21 START test unique_stg_orders_order_pk ................................. [RUN]
[0m14:49:15.118421 [debug] [Thread-3 (]: Finished running node test.data_models.not_null_stg_products_product_sku.ae077a8c6f
[0m14:49:15.118814 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_orders_order_pk.5306dc2b5e, now test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7)
[0m14:49:15.120829 [debug] [Thread-4 (]: Began compiling node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:49:15.120169 [debug] [Thread-3 (]: Began running node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:49:15.120507 [debug] [Thread-1 (]: Began executing node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:49:15.119609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_products_product_pk.a8fc9d1a7d, now test.data_models.unique_stg_orders_order_pk.11e6f1ee83)
[0m14:49:15.125808 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:49:15.126397 [info ] [Thread-3 (]: 20 of 21 START test unique_stg_products_product_pk ............................. [RUN]
[0m14:49:15.130778 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:49:15.132380 [debug] [Thread-2 (]: Began compiling node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:49:15.136176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_models.not_null_stg_products_product_sku.ae077a8c6f, now test.data_models.unique_stg_products_product_pk.954d888382)
[0m14:49:15.137263 [debug] [Thread-4 (]: Began executing node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:49:15.140965 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:49:15.141434 [debug] [Thread-3 (]: Began compiling node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:49:15.141879 [debug] [Thread-1 (]: Using postgres connection "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:49:15.144008 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:49:15.148960 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:49:15.149485 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: BEGIN
[0m14:49:15.149912 [debug] [Thread-2 (]: Began executing node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:49:15.150647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.151119 [debug] [Thread-4 (]: Using postgres connection "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:49:15.152985 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:49:15.153379 [debug] [Thread-3 (]: Began executing node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:49:15.153911 [debug] [Thread-4 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: BEGIN
[0m14:49:15.156774 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:49:15.158411 [debug] [Thread-2 (]: Using postgres connection "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:49:15.158843 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:15.160164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:49:15.163167 [debug] [Thread-1 (]: Using postgres connection "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"
[0m14:49:15.162354 [debug] [Thread-3 (]: Using postgres connection "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:49:15.161239 [debug] [Thread-2 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: BEGIN
[0m14:49:15.164036 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select units_sold as from_field
    from (select * from "primary_app_db"."public_analytics"."fact_sales" where product_key IS NOT NULL) dbt_subquery
    where units_sold is not null
),

parent as (
    select product_pk as to_field
    from "primary_app_db"."public_analytics"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:49:15.164597 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: BEGIN
[0m14:49:15.169035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:15.168494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.165839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:15.173284 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: ROLLBACK
[0m14:49:15.174070 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m14:49:15.176157 [debug] [Thread-1 (]: On test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb: Close
[0m14:49:15.178124 [debug] [Thread-4 (]: Using postgres connection "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"
[0m14:49:15.178636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:15.180503 [debug] [Thread-3 (]: Using postgres connection "test.data_models.unique_stg_products_product_pk.954d888382"
[0m14:49:15.180063 [debug] [Thread-4 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_order_items"
where order_item_pk is not null
group by order_item_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:49:15.179488 [info ] [Thread-1 (]: 17 of 21 PASS relationships_fact_sales_units_sold__product_pk__ref_dim_products_  [[32mPASS[0m in 0.07s]
[0m14:49:15.180881 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_products_product_pk.954d888382"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_products"
where product_pk is not null
group by product_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:49:15.181615 [debug] [Thread-1 (]: Finished running node test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb
[0m14:49:15.181914 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:49:15.182254 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.182691 [debug] [Thread-1 (]: Began running node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:49:15.183106 [debug] [Thread-2 (]: Using postgres connection "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"
[0m14:49:15.183418 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.184812 [debug] [Thread-4 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: ROLLBACK
[0m14:49:15.185264 [info ] [Thread-1 (]: 21 of 21 START test unique_stg_products_product_sku ............................ [RUN]
[0m14:49:15.185663 [debug] [Thread-2 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_orders_order_pk.11e6f1ee83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_pk as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_orders"
where order_pk is not null
group by order_pk
having count(*) > 1



      
    ) dbt_internal_test
[0m14:49:15.186908 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: ROLLBACK
[0m14:49:15.187404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_models.relationships_fact_sales_units_sold__product_pk__ref_dim_products_.5e82ffdafb, now test.data_models.unique_stg_products_product_sku.ad8bf684d5)
[0m14:49:15.187688 [debug] [Thread-4 (]: On test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7: Close
[0m14:49:15.188183 [debug] [Thread-3 (]: On test.data_models.unique_stg_products_product_pk.954d888382: Close
[0m14:49:15.188427 [debug] [Thread-1 (]: Began compiling node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:49:15.188950 [info ] [Thread-4 (]: 18 of 21 PASS unique_stg_order_items_order_item_pk ............................. [[32mPASS[0m in 0.07s]
[0m14:49:15.189255 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.189698 [info ] [Thread-3 (]: 20 of 21 PASS unique_stg_products_product_pk ................................... [[32mPASS[0m in 0.05s]
[0m14:49:15.195236 [debug] [Thread-3 (]: Finished running node test.data_models.unique_stg_products_product_pk.954d888382
[0m14:49:15.193392 [debug] [Thread-4 (]: Finished running node test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7
[0m14:49:15.194748 [debug] [Thread-2 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: ROLLBACK
[0m14:49:15.192872 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:49:15.196085 [debug] [Thread-2 (]: On test.data_models.unique_stg_orders_order_pk.11e6f1ee83: Close
[0m14:49:15.196635 [info ] [Thread-2 (]: 19 of 21 PASS unique_stg_orders_order_pk ....................................... [[32mPASS[0m in 0.08s]
[0m14:49:15.198818 [debug] [Thread-1 (]: Began executing node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:49:15.199271 [debug] [Thread-2 (]: Finished running node test.data_models.unique_stg_orders_order_pk.11e6f1ee83
[0m14:49:15.201032 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:49:15.201822 [debug] [Thread-1 (]: Using postgres connection "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:49:15.202111 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: BEGIN
[0m14:49:15.202374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.207812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:49:15.208394 [debug] [Thread-1 (]: Using postgres connection "test.data_models.unique_stg_products_product_sku.ad8bf684d5"
[0m14:49:15.208777 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "data_models", "target_name": "prod", "node_id": "test.data_models.unique_stg_products_product_sku.ad8bf684d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_sku as unique_field,
    count(*) as n_records

from "primary_app_db"."public_staging"."stg_products"
where product_sku is not null
group by product_sku
having count(*) > 1



      
    ) dbt_internal_test
[0m14:49:15.210410 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:49:15.211972 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: ROLLBACK
[0m14:49:15.212439 [debug] [Thread-1 (]: On test.data_models.unique_stg_products_product_sku.ad8bf684d5: Close
[0m14:49:15.213144 [info ] [Thread-1 (]: 21 of 21 PASS unique_stg_products_product_sku .................................. [[32mPASS[0m in 0.03s]
[0m14:49:15.213798 [debug] [Thread-1 (]: Finished running node test.data_models.unique_stg_products_product_sku.ad8bf684d5
[0m14:49:15.216528 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.216891 [debug] [MainThread]: On master: BEGIN
[0m14:49:15.217212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:15.222589 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:49:15.222957 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.223257 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.223528 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.223880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:15.224164 [debug] [MainThread]: On master: Close
[0m14:49:15.224594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:15.224943 [debug] [MainThread]: Connection 'test.data_models.unique_stg_orders_order_pk.11e6f1ee83' was properly closed.
[0m14:49:15.225246 [debug] [MainThread]: Connection 'test.data_models.unique_stg_products_product_sku.ad8bf684d5' was properly closed.
[0m14:49:15.225551 [debug] [MainThread]: Connection 'test.data_models.unique_stg_products_product_pk.954d888382' was properly closed.
[0m14:49:15.225861 [debug] [MainThread]: Connection 'test.data_models.unique_stg_order_items_order_item_pk.eba4337cc7' was properly closed.
[0m14:49:15.226412 [info ] [MainThread]: 
[0m14:49:15.226772 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m14:49:15.229984 [debug] [MainThread]: Command end result
[0m14:49:15.286325 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:49:15.287997 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:49:15.295051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:49:15.295363 [info ] [MainThread]: 
[0m14:49:15.295743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:15.296076 [info ] [MainThread]: 
[0m14:49:15.296476 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m14:49:15.297752 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2750149, "process_in_blocks": "0", "process_kernel_time": 0.166596, "process_mem_max_rss": "131392", "process_out_blocks": "2618", "process_user_time": 2.121597}
[0m14:49:15.298222 [debug] [MainThread]: Command `dbt test` succeeded at 14:49:15.298129 after 1.28 seconds
[0m14:49:15.298540 [debug] [MainThread]: Flushing usage events
